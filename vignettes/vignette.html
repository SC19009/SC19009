<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="SC19009" />

<meta name="date" content="2019-12-27" />

<title>Vignette for the final</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Vignette for the final</h1>
<h4 class="author">SC19009</h4>
<h4 class="date">2019-12-27</h4>



<div id="part-1-introduction-for-the-two-functions" class="section level1">
<h1>Part 1: Introduction for the two functions</h1>
<div id="function_1-bca" class="section level2">
<h2>Function_1: BCa</h2>
<p>The function BCa calculates BCa confidence interval for population mean in R.<br />
The source R code for BCa is as following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">BCa&lt;-<span class="cf">function</span>(x,alpha,B){</a>
<a class="sourceLine" id="cb1-2" title="2">  n&lt;-<span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb1-3" title="3">  bar&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb1-4" title="4">  </a>
<a class="sourceLine" id="cb1-5" title="5">  bar.boot&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb1-7" title="7">    j&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">    bar.boot[i]&lt;-<span class="kw">mean</span>(x[j])</a>
<a class="sourceLine" id="cb1-9" title="9">  }</a>
<a class="sourceLine" id="cb1-10" title="10">  </a>
<a class="sourceLine" id="cb1-11" title="11">  bar.jack&lt;-(<span class="kw">sum</span>(x)<span class="op">-</span>x)<span class="op">/</span>(n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">  bar0.jack&lt;-<span class="kw">mean</span>(bar.jack)</a>
<a class="sourceLine" id="cb1-13" title="13">  </a>
<a class="sourceLine" id="cb1-14" title="14">  z&lt;-<span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-15" title="15">  z0&lt;-<span class="kw">qnorm</span>(<span class="kw">mean</span>(bar.boot<span class="op">&lt;</span>bar))</a>
<a class="sourceLine" id="cb1-16" title="16">  alpha0&lt;-<span class="kw">sum</span>((bar0.jack<span class="op">-</span>bar.jack)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span><span class="kw">sum</span>(<span class="kw">abs</span>(bar0.jack<span class="op">-</span>bar.jack)<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1-17" title="17">  </a>
<a class="sourceLine" id="cb1-18" title="18">  alpha1&lt;-<span class="kw">pnorm</span>(z0<span class="op">+</span>(z0<span class="op">+</span>z)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>alpha0<span class="op">*</span>(z0<span class="op">+</span>z)))</a>
<a class="sourceLine" id="cb1-19" title="19">  alpha2&lt;-<span class="kw">pnorm</span>(z0<span class="op">+</span>(z0<span class="op">-</span>z)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>alpha0<span class="op">*</span>(z0<span class="op">-</span>z)))</a>
<a class="sourceLine" id="cb1-20" title="20">  </a>
<a class="sourceLine" id="cb1-21" title="21">  lb.BCa&lt;-<span class="kw">quantile</span>(bar.boot,alpha1,<span class="dt">names=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-22" title="22">  ub.BCa&lt;-<span class="kw">quantile</span>(bar.boot,alpha2,<span class="dt">names=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-23" title="23">  </a>
<a class="sourceLine" id="cb1-24" title="24">  out&lt;-<span class="kw">c</span>(lb.BCa,ub.BCa)</a>
<a class="sourceLine" id="cb1-25" title="25">  <span class="kw">names</span>(out)&lt;-<span class="kw">c</span>(<span class="st">&quot;lb&quot;</span>,<span class="st">&quot;ub&quot;</span>)</a>
<a class="sourceLine" id="cb1-26" title="26">  <span class="kw">return</span>(out)</a>
<a class="sourceLine" id="cb1-27" title="27">}</a></code></pre></div>
<p>To implement BCa, input a vector composed of sample points, confidence level and number of bootstrap replicates. Corresponding output is a named vecotr representing the confidence interval.<br />
A simple implementation is as following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(SC19009)</a>
<a class="sourceLine" id="cb2-2" title="2">x&lt;-<span class="kw">rbeta</span>(<span class="dv">200</span>,<span class="dv">4</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">BCa</span>(x,<span class="fl">0.95</span>,<span class="dv">500</span>)</a></code></pre></div>
<pre><code>##        lb        ub 
## 0.4819356 0.5257528</code></pre>
</div>
<div id="function_2jack" class="section level2">
<h2>Function_2:jack</h2>
<p>The function jack conducts a jackknife estimation in C++.<br />
The source C++ code for jack is as following:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">NumericVector <span class="kw">jack</span>(NumericVector x){</a>
<a class="sourceLine" id="cb4-2" title="2">  int n=<span class="kw">sizeof</span>(x); double s=<span class="kw">sum</span>(x); double bar0=s<span class="op">/</span>n;</a>
<a class="sourceLine" id="cb4-3" title="3">  double bar[n]; double y[n]; double sum1=<span class="dv">0</span>; double sum2=<span class="dv">0</span>;</a>
<a class="sourceLine" id="cb4-4" title="4">  </a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="cf">for</span> (int <span class="dt">i=</span><span class="dv">0</span>;i<span class="op">&lt;=</span>n<span class="dv">-1</span>;i<span class="op">++</span>){</a>
<a class="sourceLine" id="cb4-6" title="6">    bar[i]=(s<span class="op">-</span>x[i])<span class="op">/</span>(n<span class="dv">-1</span>);</a>
<a class="sourceLine" id="cb4-7" title="7">    sum1=sum1<span class="op">+</span>bar[i];</a>
<a class="sourceLine" id="cb4-8" title="8">  }</a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10">  double bar1=sum1<span class="op">/</span>n;</a>
<a class="sourceLine" id="cb4-11" title="11">  double jack=n<span class="op">*</span>bar0<span class="op">-</span>(n<span class="dv">-1</span>)<span class="op">*</span>bar1;</a>
<a class="sourceLine" id="cb4-12" title="12">  </a>
<a class="sourceLine" id="cb4-13" title="13">  <span class="cf">for</span> (int <span class="dt">i=</span><span class="dv">0</span>;i<span class="op">&lt;=</span>n<span class="dv">-1</span>;i<span class="op">++</span>){</a>
<a class="sourceLine" id="cb4-14" title="14">    double z=bar[i]<span class="op">-</span>bar1;</a>
<a class="sourceLine" id="cb4-15" title="15">    y[i]=z<span class="op">*</span>z;</a>
<a class="sourceLine" id="cb4-16" title="16">    sum2=sum2<span class="op">+</span>y[i];</a>
<a class="sourceLine" id="cb4-17" title="17">  }</a>
<a class="sourceLine" id="cb4-18" title="18">  </a>
<a class="sourceLine" id="cb4-19" title="19">  double var=(n<span class="dv">-1</span>)<span class="op">*</span>sum2<span class="op">/</span>n;</a>
<a class="sourceLine" id="cb4-20" title="20">  </a>
<a class="sourceLine" id="cb4-21" title="21">  NumericVector out=<span class="st"> </span>NumericVector<span class="op">::</span><span class="kw">create</span>(jack,var);</a>
<a class="sourceLine" id="cb4-22" title="22">  <span class="kw">return</span> (out);</a>
<a class="sourceLine" id="cb4-23" title="23">}</a></code></pre></div>
<p>To implement jack, input a vector composed of sample points. Corresponding output is a 2-dimension named vector, whose first element is the mean estimate: <span class="math inline">\(\hat\mu\)</span> and the second element is the variance estimate for the estimated mean: <span class="math inline">\(\hat{Var}(\hat\mu)\)</span>.<br />
A simple implementation for jack is as following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">y&lt;-<span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">4</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">jack</span>(y)</a></code></pre></div>
<pre><code>##      jack       var 
## 0.6573545 1.0362101</code></pre>
</div>
</div>
<div id="part-2-all-homework-answers" class="section level1">
<h1>Part 2: All homework answers</h1>
</div>
<div id="section" class="section level1">
<h1>2019-9-20</h1>
<div id="example-1-texts" class="section level2">
<h2>Example 1 : texts</h2>
<p>* An Introduction about tinytex derived from <a href="https://yihui.name/tinytex/" class="uri">https://yihui.name/tinytex/</a>: TinyTeX is a custom LaTeX distribution based on TeX Live that is small in size (150Mb on macOS/Linux and 220Mb on Windows) but functions well in most cases, especially for R users. If you run into the problem of missing LaTeX packages, it should be super clear to you what you need to do (in fact, R users won’t need to do anything). You only install LaTeX packages you actually need.</p>
<p>* A few packages applicable for reproducibility while using R: knitr, rmarkdown, rticles, xtable, devtools,</p>
</div>
<div id="example-2-figures" class="section level2">
<h2>Example 2 : figures</h2>
<p>* I utilised three different functions to create diffrent graphics</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">x&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">y&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">plot</span>(<span class="kw">c</span>(x,y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">hist</span>(<span class="kw">c</span>(x,y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">barplot</span>(<span class="kw">c</span>(x,y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-tables" class="section level2">
<h2>Example 3 : tables</h2>
<p>* Here’s a simple table composed of three person’s name and their age</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">name&lt;-<span class="kw">c</span>(<span class="st">&quot;Tom&quot;</span>,<span class="st">&quot;Tony&quot;</span>,<span class="st">&quot;Tomy&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">age&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">table</span>(name,age)</a></code></pre></div>
<pre><code>##       age
## name   20 30 40
##   Tom   1  0  0
##   Tomy  0  0  1
##   Tony  0  1  0</code></pre>
<p>* The second table consists of a Poisson variable and its frequency with 100 samples</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">x&lt;-<span class="kw">rpois</span>(<span class="dv">100</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">ftable</span>(x)</a></code></pre></div>
<pre><code>## x  0  1  2  3  4  5  6
##                       
##    6 12 22 22 17 16  5</code></pre>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2019-9-29</h1>
<div id="section-2" class="section level2">
<h2>3.4</h2>
<div id="basic-idea" class="section level3">
<h3>(1) Basic idea</h3>
<p>Through calculation , we can derive the distribution fuction of the objective density function , namely : <span class="math display">\[F(x)=1-e^{-x^{2} /\left(2 \sigma^{2}\right)} \quad, x \geq 0, \sigma&gt;0.\]</span> Evidently , when <span class="math inline">\(x\in[0,+\infty)\)</span> , <span class="math inline">\(F(x)\)</span> is continuous and strictly increasing . Moreover , we can get its inverse funtion : <span class="math display">\[F^{-1}(y)=\sqrt{-2\sigma^{2} \ln (1-y)} \quad ,0 \leqslant y \leqslant 1, \sigma&gt;0.\]</span> Hence , an intuitive way to generate random samples from this distribution is the inverse transform method .</p>
</div>
<div id="code-and-results" class="section level3">
<h3>(2) Code and results</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Define the function to generate samples with varing sigma^2</span></a>
<a class="sourceLine" id="cb14-2" title="2">Inv.sample&lt;-<span class="cf">function</span>(n,sigma.square) {</a>
<a class="sourceLine" id="cb14-3" title="3">  u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb14-4" title="4">  y&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma.square<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb14-6" title="6">}</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co"># Generate samples</span></a>
<a class="sourceLine" id="cb14-9" title="9">x&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">2000</span>,<span class="dt">ncol=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb14-10" title="10">sigma.square&lt;-<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)  <span class="co">## Choose different sigma^2</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) x[,i]&lt;-<span class="kw">Inv.sample</span>(<span class="dv">2000</span>,sigma.square[i])</a>
<a class="sourceLine" id="cb14-12" title="12"></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co"># Visualization of samples and theoretical density</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="kw">hist</span>(x[,i],<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma.square=&quot;</span>,sigma.square[i])) <span class="co">## histogram</span></a>
<a class="sourceLine" id="cb14-16" title="16">  y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb14-17" title="17">  <span class="kw">lines</span>(y,y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma.square[i]))<span class="op">/</span>sigma.square[i]) <span class="co">## theoretical density curve</span></a>
<a class="sourceLine" id="cb14-18" title="18">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="result-evaluation" class="section level3">
<h3>(3) Result evaluation</h3>
<p>According to the figures above , the histogram coincide well with the theoretical density curve after choosing different <span class="math inline">\(\sigma^{2}\)</span> therein . As <span class="math inline">\(\sigma^{2}\)</span> increases,the curve becomes flater .</p>
</div>
</div>
<div id="section-3" class="section level2">
<h2>3.11</h2>
<div id="basic-idea-1" class="section level3">
<h3>(1) Basic idea</h3>
<p>Since the function to generate samples from normal distribution is available in R , considering the form of our objective distribution (mixture distibution) : <span class="math inline">\(F(x)=p_{1} F_{1}(x)+\left(1-p_{1}\right) F_{2}(x)\)</span> , an ideal way to generate random samples from <span class="math inline">\(F\)</span> is transformation method .</p>
</div>
<div id="code-and-results-1" class="section level3">
<h3>(2) Code and results</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Define the function to generate samples with varying p1</span></a>
<a class="sourceLine" id="cb15-2" title="2">Trans.sample&lt;-<span class="cf">function</span>(p1) {</a>
<a class="sourceLine" id="cb15-3" title="3">  x1&lt;-<span class="kw">rnorm</span>(<span class="dv">1000</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">  x2&lt;-<span class="kw">rnorm</span>(<span class="dv">1000</span>,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">  r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(p1,<span class="dv">1</span><span class="op">-</span>p1))</a>
<a class="sourceLine" id="cb15-6" title="6">  x&lt;-r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb15-7" title="7">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb15-8" title="8">}</a>
<a class="sourceLine" id="cb15-9" title="9"></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co"># Sampling with the given probabilty : p1=0.75</span></a>
<a class="sourceLine" id="cb15-11" title="11">x0&lt;-<span class="kw">Trans.sample</span>(<span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw">hist</span>(x0,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;p1=0.75&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Sampling with different p1</span></a>
<a class="sourceLine" id="cb16-2" title="2">p1&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-3" title="3">x&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">1000</span>,<span class="dt">ncol=</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb16-4" title="4">y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</a>
<a class="sourceLine" id="cb16-6" title="6">  x[,i]&lt;-<span class="kw">Trans.sample</span>(p1[i])</a>
<a class="sourceLine" id="cb16-7" title="7">  <span class="kw">hist</span>(x[,i],<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;p1=&quot;</span>,p1[i]))</a>
<a class="sourceLine" id="cb16-8" title="8">  <span class="kw">lines</span>(y,p1[i]<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p1[i])<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">1</span>)) <span class="co">## superimposing density</span></a>
<a class="sourceLine" id="cb16-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6Ojo6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb2//b/9vb////tmb/25D/27b//7b//9v///9qIn5BAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJtklEQVR4nO2da3ubNhiG5TRxtzXeujXeVnboNrpDcGP+/78bIAmDg/Qg0Mn2c3/IZcfkxbojvUISlkVNrIjUbyB3KAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIECOggpx/zz1++MvQmx+OL305afx8yDkJ6jVMCnouBctD/r5y278PAzZCfrnO2EQVIrNz/VnIZ765+JD++Np4lh/5CCoEHe/vRfizae6K/Vm2wk6bIVk87E7qqlAD/pn9/zXr5rDmqNuQdDJRCne/L6fFNS0qMf6PEEdC/1yKDIRdPep/rtLJ5/fPR+nBTXPpaC7v/q/rJp6F9ZPLoKe6lPRlaBzpgQ1DVK8C/vm8hDUlblUdcVBUJPT5W/DkZGgSnVIDk1s4rlvMhJ0VoNmJelbETSVgya6+ebXp27+y/vtlDDfZCKo78VqYw5qa9gHeaHYHdH8aNQ1f3ULOUii2opJ0GmoIY9QVSxsBcpE0N2fzbjzm0/yqUlQM0rbysGpOuLL+xsZrIbOs6ugIAAFASgIkIOgrKEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwI8g0eMlnNuZA5/A6Wh1o6n5hqf4gkKf0il8qe9Jrkw3J9+2oOO+11Ia7k6+bUEvu/7DfZWhkd22INYgRKk/H5pBDlLdVysoaEfmFlt9Etv8+YiIguocBcUOZz0TBYEzZSuoEuaPYt+6oEKIx8PXz8MOf024NWQpqGiSc9HVnqTdvBr15SeoqzeHt62gpBeKnZI8BbVXP8d/69Q1KFdBdanrjVQ1iBJ1uuNMUNizusUuZfdVGXdcufEaFD2c6SQUZIzfyrgEQWWiXqzTcgmCIoWbiE9BIH4vSPTXixQ0jD8Q1D7PTFDyVY1eUD/UEDkJSr+qodNPnoIymJPuBcVP0i87uKdlBqsaU4KiDTXaLeWsmxVlUoP6zmvQ3EKecQhwlH5Vo+/hB4Li5qDS1kelX9UYN7Hogiohdwhz3vUq2nSHrj4pBLW1Q5oxZWCncGEwCAp42kEv5mPX2GsW9K30s6L61PFzkIgvyDSR4RguEIYkHdCQilyc0uyqfRtT9WLBBZ1qkKdwgRgJGl4OBatDlzbdIQw1iIJU/ESCXnaP+iJ53ZZ91yoo13AT8U1JmoK68BZBgU49HGo8tkPVdbsPh7xiE1hQgJZ2CljcPx+2D3Wx6qtgUgvy/wYGY7Gnbs0926GGSsVmQSK8oKKRYxlqyHs6qomeLsZ0x6gDmxTUz+R7PW3/qHh42d0/v+zMTawT1E22prgFb4agoDWonQ/afDzuLSmoFaTUJJiTTi4I0wo6bDtBCVY1oKA6C0EZ16DQguCyspqyf6hf34I3Ec47sBfTL3s+bf+omNO/d4nKvOoTWhCoQUEFGSvFsnD+SS/Ix1fheXh7uojji6rz1dSxIBFBkLWDdw+3IoQWVM8XNHrsl1M88729i8ItD5GpoBkTZv0h5qPCCZqTg+oAgx2neMc96ulCCRKXIQgnqqsW1LSg++fC3tkbEpWf0bxQk176nYnBCzMF+Vc0SNKbj2U7mk+3cCiVTAqam4Nq7zMeg27+sRthJVx6zltQe6HYCoo+o6jaRD/dlasgXYOKWbP2Hj+roUrUl+21oIm1sASCVA4q110uhhA0tViYIknL68CVd1EFEeTWxMIJShQOCRKXJCjEZzW0Fn0ZdSZICMckHUqQHGjZM3SQz2qIWq/Y9I/072ulyzFJe1WkYxUyOZe2G8zC3GkvlATVxHpD6ln30E2Q17yhYlU6OatVi0nCfFZDXwedcpDQq6S9q+Q1aDAItazNe65BfcoZFFHo+jQa2TkL8mhIhhqMwGxDDb+f1dAt6nURTy+rhxkIgo1HHSf/s14+q2EuYv+yPtI1ByUTZIyyZLpD9NfIrwWpbm1ZDspQ0Fm4ucdaBI1KequChLmJ5ScITse7hLMeMeibdB0aZepJQUaXBkH+EnX0sZiox4LC1CAhfJUsnSBLqSlIj75OxRJnj8cNzlnQoKIGL5HncFJQfS7IUuplgi47B9n+7xQkhvmZgl4fEUfQRecgYSuWN0F+ipZC0OQI3ljqVx3eHEH+GlkSQdaGMevlWTXoYgU59mLLD41ToiGmVQ2H6Q49nWotNczhc12uxymGj1WNWYI81SAfhlxC+JiTlv1SJEE+GplLiHWrGrLqqH4pVg1abyheDfJWaqdDVxtyzEErVjXOqk4cQesNuf398lWNvpeLLEj/WOwp1nWQqP313U6CZD1aXs5ogmYk5jCC9DPfJZpk8e0vs3ou/4KEnr1c3qNFuVA0rX+Fr0H97KVYWokidPPWNZsogupIgmZfKJ6m2geDtESCBs1tUX8WpAbJ/5YWE7LUTocuaml+LhTPRvMiawIKwheK14fn66Drg4IACwWt+0zQJRGpBqVNy0Oc33kIHUtO4+MIP0FW/sEybkUQ3gBl8WmuQhAerC4/zTUImjHUWH6aaxC04l7Y2xDEGoTAqxrLT3MVgpYPVm9F0A1CQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAHEEdXPZlhmSCm19hQIowAZsh62A37Z7ThRBx31T/NL83tq9ZyqbIRRAx7HPw1TNq7ZvfZgkiiC5545xNVbOVNq+EgYEUHRbiZpflqdxXROOmIOMdWRe8S0BFOX9jzZBh7dLNrCLKMi4ab5853gdAOy634Sx5qDq7o+d+1c4xhNknseWNQPVDzQR3rYgq6CyXe903ng9mqDKnqOxIEuADriNaLmZV1HHxBJk+/fPamJoIaULYhfUncC2SdsUoQWpL2i37q43J0lbA+gTtZiLL/8Drqk6Tg2y7xCLu3kQoMdag+TCcJZN7LAF+5yjC0UUQGO/km6z1GB1eB5RBKnqb1ZQgqEGDKAAQ41q1nhlDAerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQO6C2vvOBl9RGZ/cBelveU9G7oLau5u/XfcN5uvIXlBdOH/+xCv5C6rm3b8ZiuwFHfffJ92SMHtB5f1/rjemeiV3Qe3Nzeu++nUluQsqunubE6bp3AUlh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPnQHjq2+ZlaAAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conjecture" class="section level3">
<h3>(3) Conjecture</h3>
<p>The sample from objective mixture distribution with <span class="math inline">\(p_{1}\)</span>=0.75 is graphed in the first histogram above .<br />
As <span class="math inline">\(p_{1}\)</span> increases from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> , the histogram deviates from right to left .<br />
Besides , it can be infered from a series of histogram where samples are derived with different <span class="math inline">\(p_{1}\)</span> that bimodal mixtures is produced when <span class="math inline">\(p_{1}\)</span>=0.5 , which can be characterized by that the curve of <span class="math inline">\(f\)</span> has two peaks : <span class="math inline">\(f(0)=f(3)=\max _{x} f(x)\)</span> .</p>
</div>
</div>
<div id="section-4" class="section level2">
<h2>3.18</h2>
<div id="basic-idea-2" class="section level3">
<h3>(1) Basic idea</h3>
<p>The definition of Wishart-distribution can be summarized as below :<br />
Given <span class="math display">\[X=\left(\begin{array}{c}{X_{1}} \\ {\vdots} \\ {X_{n}}\end{array}\right)\ ;\ X_{1}, \ldots, X_{n} \ i.i.d \sim N_{d}(\mu, \Sigma)\]</span> then <span class="math display">\[W=X^{T} X \sim W_{d}(\Sigma, n)\]</span> A straight-forward method is to generate sample matrix <span class="math inline">\(X\)</span> via multivariate normal distribution , and calculate <span class="math inline">\(W=X^{T} X\)</span> . However , such method is inefficient because each sample entails <span class="math inline">\(n\)</span> samples from the population <span class="math inline">\(N_{d}(\mu, \Sigma)\)</span> , not to mention the calculation of W .<br />
According to the requirement of the question , an appropriate way is Bartlett’s decomposition along with Choleski factorization .</p>
</div>
<div id="code" class="section level3">
<h3>(2) Code</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># Define the function to generate Wishart samples with different n &amp; d</span></a>
<a class="sourceLine" id="cb17-2" title="2">Wis.sample&lt;-<span class="cf">function</span>(d,n,sigma) {</a>
<a class="sourceLine" id="cb17-3" title="3">  T&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="cf">if</span> (n<span class="op">&gt;</span>(d<span class="op">+</span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">&gt;</span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb17-5" title="5">    <span class="co">## Common case when d&gt;1</span></a>
<a class="sourceLine" id="cb17-6" title="6">    <span class="cf">if</span> (d<span class="op">&gt;</span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb17-7" title="7">      <span class="co">### Generate lower triangular entries</span></a>
<a class="sourceLine" id="cb17-8" title="8">      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>d) {</a>
<a class="sourceLine" id="cb17-9" title="9">        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>) T[i,j]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-10" title="10">      }</a>
<a class="sourceLine" id="cb17-11" title="11"></a>
<a class="sourceLine" id="cb17-12" title="12">      <span class="co">### Generate entries on the diagonal</span></a>
<a class="sourceLine" id="cb17-13" title="13">      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d) {</a>
<a class="sourceLine" id="cb17-14" title="14">        x&lt;-<span class="kw">rnorm</span>(n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-15" title="15">        T[i,i]&lt;-<span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb17-16" title="16">      }</a>
<a class="sourceLine" id="cb17-17" title="17">  </a>
<a class="sourceLine" id="cb17-18" title="18">      <span class="co">### Calculate the final result</span></a>
<a class="sourceLine" id="cb17-19" title="19">      A=T<span class="op">%*%</span><span class="kw">t</span>(T)</a>
<a class="sourceLine" id="cb17-20" title="20">      L&lt;-<span class="kw">t</span>(<span class="kw">chol</span>(sigma)) <span class="co">#### Choleski factorization</span></a>
<a class="sourceLine" id="cb17-21" title="21">      B=L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb17-22" title="22">      <span class="kw">return</span>(B)</a>
<a class="sourceLine" id="cb17-23" title="23">    }</a>
<a class="sourceLine" id="cb17-24" title="24">    <span class="co">## Special case when d=1</span></a>
<a class="sourceLine" id="cb17-25" title="25">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb17-26" title="26">      x&lt;-<span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sigma)</a>
<a class="sourceLine" id="cb17-27" title="27">      B&lt;-<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-28" title="28">      <span class="kw">return</span>(B)</a>
<a class="sourceLine" id="cb17-29" title="29">    }</a>
<a class="sourceLine" id="cb17-30" title="30">  }</a>
<a class="sourceLine" id="cb17-31" title="31">  <span class="cf">else</span> <span class="kw">warning</span>(<span class="st">&quot;Input Error&quot;</span>)</a>
<a class="sourceLine" id="cb17-32" title="32">}</a></code></pre></div>
</div>
<div id="output-test" class="section level3">
<h3>(3) Output test</h3>
<p>To test if this function is applicable , I try sampling with it :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># General samples</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co">## Omit this line to generate different samples if necessary</span></a>
<a class="sourceLine" id="cb18-3" title="3">sigma&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.2</span>,.<span class="dv">8</span>,.<span class="dv">8</span>,.<span class="dv">8</span>,<span class="fl">1.3</span>,.<span class="dv">8</span>,.<span class="dv">8</span>,.<span class="dv">8</span>,<span class="fl">1.4</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">X1&lt;-<span class="kw">Wis.sample</span>(<span class="dv">3</span>,<span class="dv">5</span>,sigma)</a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co"># Special sample with d=1</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb18-8" title="8">sigma0&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb18-9" title="9">X2&lt;-<span class="kw">Wis.sample</span>(<span class="dv">1</span>,<span class="dv">3</span>,sigma0)</a>
<a class="sourceLine" id="cb18-10" title="10"></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co"># Output</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="kw">print</span>(X1)</a></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]
## [1,] 6.509584 3.825510 4.319123
## [2,] 3.825510 3.628696 3.152061
## [3,] 4.319123 3.152061 6.040747</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">print</span>(X2)</a></code></pre></div>
<pre><code>## [1] 67.74968</code></pre>
<p>Both two cases satisfy that <span class="math inline">\(n&gt;d+1&gt;1\)</span> . (The original statement in the book is that <span class="math inline">\(n&gt;d+1\geq1\)</span> , but <span class="math inline">\(d=0\)</span> is meaningless .)<br />
For simplicity , I set the matrix <span class="math inline">\(\Sigma\)</span> as : <span class="math display">\[\sum=\left(\begin{array}{ccc}{1.2} &amp; {0.8} &amp; {0.8} \\ {0.8} &amp; {1.3} &amp; {0.8} \\ {0.8} &amp; {0.8} &amp; {1.4}\end{array}\right)\]</span> It’s easy to verify that <span class="math inline">\(\Sigma\)</span> is symmetric and (semi) positive definite through its eigenvalues , thus it can be defined as a covariance matrix . In other words , <span class="math inline">\(X1\)</span> conforms to the definition of Wishart distribution .<br />
We can tell from the output that the sampling process is functioning .</p>
</div>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2019-10-11</h1>
<div id="section-6" class="section level2">
<h2>5.1</h2>
<div id="basic-idea-3" class="section level3">
<h3>(1) Basic idea</h3>
<p>The object integral can be written as : <span class="math display">\[\int_{0}^{\pi/3}\operatorname{sin}t\ dt=\int_{0}^{\pi/3}\frac{\pi\operatorname{sin}t}{3}\frac{3}{\pi}\ dt\]</span> Without considering variance reduction , the estimate of it can be obtained through simple Monte Carlo integration : <span class="math display">\[\hat{\theta}=\frac{1}{n}\sum\limits_{i=1}^n\frac{\pi\operatorname{sin}(x_i)}{3} \]</span> where <span class="math inline">\(x_i\)</span> is generated from the population <span class="math inline">\(U(0,\frac{\pi}{3})\)</span> , <span class="math inline">\(i=1,2,\ldots,n\)</span> .<br />
Through computation , the exact value of the integral is <span class="math inline">\(1-\operatorname{cos}(\pi/3)\)</span> .</p>
</div>
<div id="code-and-output" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-2" title="2">x&lt;-<span class="kw">runif</span>(<span class="dv">10000</span>,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb22-3" title="3">MC&lt;-<span class="kw">mean</span>(pi<span class="op">*</span><span class="kw">sin</span>(x)<span class="op">/</span><span class="dv">3</span>) <span class="co"># Monte Carlo integration</span></a>
<a class="sourceLine" id="cb22-4" title="4">I&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>) <span class="co"># Exact value</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="kw">print</span>(<span class="kw">c</span>(MC,I))</a></code></pre></div>
<pre><code>## [1] 0.4997336 0.5000000</code></pre>
</div>
<div id="comparison" class="section level3">
<h3>(3) Comparison</h3>
<p>As shown above , the estimate of <span class="math inline">\(\theta=\int_{0}^{\pi/3}\operatorname{sin}\ t\ dt\)</span> is <span class="math inline">\(\hat{\theta}=\)</span> 0.4997336 , while its exact value is <span class="math inline">\(\theta=0.5\)</span> .<br />
The precision of the estimate is ideal .</p>
</div>
</div>
<div id="section-7" class="section level2">
<h2>5.10</h2>
<div id="basic-idea-4" class="section level3">
<h3>(1) Basic idea</h3>
<p>For the integrated function : <span class="math inline">\(f(x)=\frac{e^{-x}}{1+x^2}\)</span> , <span class="math inline">\(f&#39;(x)=\frac{(1-x)^2e^{-x}}{(1+x^2)^2} &gt; 0\ ,\ x \in (0,1)\)</span><br />
So , <span class="math inline">\(f\)</span> is strictly increasing in <span class="math inline">\((0,1)\)</span> . Thus , for a random variable <span class="math inline">\(X\)</span> , <span class="math inline">\(f(X)\)</span> and <span class="math inline">\(f(1-X)\)</span> are negatively correlated .<br />
According to antithetic variables method (required by the question) , after generating <span class="math inline">\(n\)</span> random numbers <span class="math inline">\(x_1\ ,\ldots,\ x_n\)</span> from <span class="math inline">\(U(0,1)\)</span> , the estimate of <span class="math inline">\(\theta=\int_{0}^1 \frac{e^{-x}}{1+x^2}dx\)</span> is :<br />
<span class="math display">\[\hat{\theta}=\frac{1}{2n}\sum\limits_{i=1}^n[\frac{e^{-x_i}}{1+x_i^2}+\frac{e^{-(1-x_i)}}{1+(1-x_i)^2}]\]</span></p>
</div>
<div id="code-and-result" class="section level3">
<h3>(2) Code and result</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">x&lt;-<span class="kw">runif</span>(<span class="dv">10000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">y&lt;-<span class="dv">1</span><span class="op">-</span>x</a>
<a class="sourceLine" id="cb24-4" title="4">f&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb24-5" title="5">  y&lt;-<span class="kw">exp</span>(x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-6" title="6">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb24-7" title="7">}</a>
<a class="sourceLine" id="cb24-8" title="8">MC0&lt;-<span class="kw">mean</span>(<span class="kw">f</span>(x))</a>
<a class="sourceLine" id="cb24-9" title="9">MC&lt;-<span class="kw">mean</span>(<span class="kw">f</span>(x)<span class="op">+</span><span class="kw">f</span>(y))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="kw">print</span>(<span class="kw">c</span>(MC0,MC))</a></code></pre></div>
<pre><code>## [1] 1.271360 1.270268</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">var</span>(<span class="kw">f</span>(x)),<span class="kw">var</span>((<span class="kw">f</span>(x)<span class="op">+</span><span class="kw">f</span>(y))<span class="op">*</span><span class="fl">0.5</span>),<span class="dv">100-100</span><span class="op">*</span><span class="kw">var</span>((<span class="kw">f</span>(x)<span class="op">+</span><span class="kw">f</span>(y))<span class="op">*</span><span class="fl">0.5</span>)<span class="op">/</span><span class="kw">var</span>(<span class="kw">f</span>(x))))</a></code></pre></div>
<pre><code>## [1]  0.010637741  0.001788511 83.187112467</code></pre>
</div>
<div id="variance-reduction" class="section level3">
<h3>(3) Variance reduction</h3>
<p>According to the result , the estimate of <span class="math inline">\(\int_{0}^1 \frac{e^{-x}}{1+x^2}dx\)</span> through Monte Carlo integration with antithetic variables is 1.2702684 .<br />
Besides , the reduction of variance in percentage is  <span class="math inline">\(1-\frac{var(\frac{f(x)+f(1-x)}{2})}{var(f(x))}\)</span> = 83.1871125% .<br />
We can tell that the antithetic variables method incured significant reduction in variance compared to simple Monte Carlo integration .</p>
</div>
</div>
<div id="section-8" class="section level2">
<h2>5.15</h2>
<div id="basic-idea-5" class="section level3">
<h3>(1) Basic idea</h3>
<p>The framework of the estimation is already given in Example 5.10 and Example 5.13 , but the original way to obtain subintervals in 5.13 is wrong . A rational modification is :<br />
1. Considering the selected importance function : <span class="math display">\[f_3(x)=\frac{e^{-x}}{1-e^{-1}}\ ,\ 0&lt;x&lt;1\]</span> Then : <span class="math display">\[F_3(x)=\frac{1-e^{-x}}{1-e^{-1}}\ ,\ 0&lt;x&lt;1\]</span> Divide the inteval <span class="math inline">\((0,1)\)</span> into five subintervals : <span class="math display">\[I_j=(F_3^{-1}(\frac{j}{5})\ ,\ F_3^{-1}(\frac{j+1}{5}))\ ,\ j=0,1,\ldots,4\]</span> The conditional density function of the population <span class="math inline">\(X\sim F_3\)</span> on each subinterval <span class="math inline">\(I_j\)</span> is <span class="math display">\[g_j(x):=f_{X|I_j}(x)=\frac{f_{X,I_j}(x)}{P(X\in I_j)}=\frac{\frac{e^{-x}}{1-e^{-1}}}{1/5}=\frac{5e^{-x}}{1-e^{-1}}\]</span> 2. It can be derived that : <span class="math display">\[G_j(x)=\frac{5(1-e^{-x})}{1-e^{-1}}-j\ ,\ x\in I_j\]</span> <span class="math display">\[G_j^{-1}(y)=-\operatorname{ln}(1-\frac{(1-e^{-1})(y+j)}{5})\ ,\ y\in [0,1]\]</span> 3. Generate <span class="math inline">\(5\times m\)</span> samples <span class="math inline">\(X_i^j \sim U(0,1)\ ,\ j=0,1,\ldots,4\ ,i=1,2,\ldots,m\)</span> . According to inverse transform method , <span class="math inline">\(Y_i^j=G_j^{-1}(X_i^j)\sim G_j\)</span> .<br />
4. For the integrated function <span class="math inline">\(f(x)=\frac{e^{-x}}{1+x^2}\)</span> , the estimation of <span class="math inline">\(\theta=\int_{0}^1 \frac{e^{-x}}{1+x^2}dx\)</span> is <span class="math display">\[\hat{\theta}^{SI}=\frac{1}{5}\sum\limits_{j=0}^4[\frac{1}{m}\sum\limits_{x_i^j\in I_j} \frac{f(F_3^{-1}(x_i^j))}{g_j(F_3^{-1}(x_i^j))}]\]</span></p>
</div>
<div id="code-and-output-1" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">f&lt;-<span class="cf">function</span>(x){          <span class="co"># Integrated function f</span></a>
<a class="sourceLine" id="cb28-2" title="2">  y&lt;-<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb28-3" title="3">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb28-4" title="4">}</a>
<a class="sourceLine" id="cb28-5" title="5"></a>
<a class="sourceLine" id="cb28-6" title="6">g&lt;-<span class="cf">function</span>(x,j){          <span class="co"># Inverse function of Gj</span></a>
<a class="sourceLine" id="cb28-7" title="7">  y&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>(x<span class="op">+</span>j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-8" title="8">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb28-9" title="9">}</a>
<a class="sourceLine" id="cb28-10" title="10"></a>
<a class="sourceLine" id="cb28-11" title="11">h&lt;-<span class="cf">function</span>(x){          <span class="co"># Density function of samples</span></a>
<a class="sourceLine" id="cb28-12" title="12">  y&lt;-<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb28-13" title="13">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb28-14" title="14">}</a>
<a class="sourceLine" id="cb28-15" title="15"></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-17" title="17">x&lt;-y&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">2000</span>,<span class="dt">ncol=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-18" title="18"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb28-19" title="19">  x[,j]&lt;-<span class="kw">runif</span>(<span class="dv">2000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb28-20" title="20">  y[,j]&lt;-<span class="kw">g</span>(x[,j],j) <span class="co"># Random numbers from population Gj</span></a>
<a class="sourceLine" id="cb28-21" title="21">}</a>
<a class="sourceLine" id="cb28-22" title="22">z&lt;-<span class="kw">f</span>(y)<span class="op">/</span><span class="kw">h</span>(y)   <span class="co"># Integrated items</span></a>
<a class="sourceLine" id="cb28-23" title="23">I&lt;-<span class="kw">colMeans</span>(z) <span class="co"># Integration on each subinterval</span></a>
<a class="sourceLine" id="cb28-24" title="24">MC&lt;-<span class="kw">sum</span>(I) <span class="co"># theta.hat</span></a>
<a class="sourceLine" id="cb28-25" title="25">sd&lt;-<span class="kw">sd</span>(z)  <span class="co"># standard variance of integrated items</span></a>
<a class="sourceLine" id="cb28-26" title="26">k&lt;-<span class="dv">100</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>sd<span class="op">/</span><span class="fl">0.0970314</span>) <span class="co"># Percentage of reduction in standard variance</span></a>
<a class="sourceLine" id="cb28-27" title="27"><span class="kw">print</span>(<span class="kw">c</span>(MC,sd,k))</a></code></pre></div>
<pre><code>## [1]  0.52511475  0.01931496 80.09411802</code></pre>
</div>
<div id="comparison-1" class="section level3">
<h3>(3) Comparison</h3>
<p>According to the textbook , through importance sampling , the estimation of <span class="math inline">\(\theta=\int_{0}^1 \frac{e^{-x}}{1+x^2}dx\)</span> with the importance function <span class="math inline">\(f_3(x)=\frac{e^{-x}}{1-e^{-1}}\ ,\ 0&lt;x&lt;1\)</span> is <span class="math inline">\(\hat{\theta}=0.5257801\)</span> . The estimated standard error is 0.0970314 .<br />
Under stratified importance sampling method , the result is <span class="math inline">\(\hat{\theta}=\)</span> 0.5251147 , <span class="math inline">\(sd=\)</span> 0.019315 . The standard variance of the integrated terms is reduced about 80.094118% .</p>
</div>
</div>
</div>
<div id="section-9" class="section level1">
<h1>2019-10-18</h1>
<div id="section-10" class="section level2">
<h2>6.5</h2>
<div id="basic-idea-6" class="section level3">
<h3>(1) Basic idea</h3>
<p>Given confidence level <span class="math inline">\(1-\alpha\)</span> , the <span class="math inline">\(t\)</span>-interval for the mean of a (normal) population is defined as : <span class="math display">\[(\bar{x}-\frac{t_{\frac{\alpha}{2}}(n-1)S_x}{\sqrt{n}},\bar{x}+\frac{t_{\frac{\alpha}{2}}(n-1)S_x}{\sqrt{n}})\]</span> where <span class="math inline">\(n\)</span> is the sample size , <span class="math inline">\(\bar{x}\)</span> is the mean of sample , <span class="math inline">\(S_x\)</span> is the sample standard deviation , <span class="math inline">\(t_{\frac{\alpha}{2}}(n-1)\)</span> represents the upper <span class="math inline">\(\frac{\alpha}{2}\)</span>-quantile of <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df=n-1\)</span><br />
As the population is already known that <span class="math inline">\(X\sim \chi^2(2)\)</span> , let <span class="math inline">\(\theta=EX=2\)</span> , for this confidence interval , the estimate of its coverage probability <span class="math inline">\(P(\hat{\theta}_1&lt;\theta&lt;\hat{\theta}_2)\)</span> is <span class="math display">\[\hat{P}=\frac{1}{m} \sum\limits_{j=1}^m I(\hat{\theta}_1^{(j)}&lt;\theta&lt;\hat{\theta}_2^{(j)})\]</span> where <span class="math inline">\((\hat{\theta}_1^{(j)},\hat{\theta}_2^{(j)})\)</span> is the confidence interval of <span class="math inline">\(\theta\)</span> in the j<span class="math inline">\(th\)</span> MC experiment .</p>
</div>
<div id="code-and-output-2" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># t-interval</span></a>
<a class="sourceLine" id="cb30-2" title="2">n&lt;-<span class="dv">20</span> <span class="co"># Required sample size</span></a>
<a class="sourceLine" id="cb30-3" title="3">a&lt;-<span class="fl">0.05</span> <span class="co"># alpha</span></a>
<a class="sourceLine" id="cb30-4" title="4">m&lt;-<span class="dv">10000</span> <span class="co"># Times to repeat MC experiment</span></a>
<a class="sourceLine" id="cb30-5" title="5">I1&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb30-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb30-7" title="7">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-8" title="8">  CI&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">c</span>(<span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n),<span class="op">-</span><span class="kw">qt</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="co"># Confidence interval</span></a>
<a class="sourceLine" id="cb30-9" title="9">  I1[i]&lt;-<span class="dv">2</span><span class="op">&lt;</span>CI[<span class="dv">2</span>]<span class="op">&amp;&amp;</span><span class="dv">2</span><span class="op">&gt;</span>CI[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb30-10" title="10">}</a>
<a class="sourceLine" id="cb30-11" title="11">p1.hat&lt;-<span class="kw">mean</span>(I1)</a>
<a class="sourceLine" id="cb30-12" title="12"></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="co"># Simulation based on example 6.4</span></a>
<a class="sourceLine" id="cb30-14" title="14">I2&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb30-16" title="16">  x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-17" title="17">  UCL&lt;-(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(a,n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb30-18" title="18">  I2[i]&lt;-<span class="dv">4</span><span class="op">&lt;</span>UCL</a>
<a class="sourceLine" id="cb30-19" title="19">}</a>
<a class="sourceLine" id="cb30-20" title="20">p2.hat&lt;-<span class="kw">mean</span>(I2)</a>
<a class="sourceLine" id="cb30-21" title="21"><span class="kw">cbind</span>(p1.hat,p2.hat)</a></code></pre></div>
<pre><code>##      p1.hat p2.hat
## [1,] 0.9228 0.9513</code></pre>
</div>
<div id="comparison-to-example-6.4" class="section level3">
<h3>(3) Comparison to Example 6.4</h3>
<p>According to the output , the estimate of <span class="math inline">\(P(\hat{\theta}_1&lt;\theta&lt;\hat{\theta}_2)\)</span> is <span class="math inline">\(\hat{P}=\)</span> 0.9228 , which is a little lower than the confidence level <span class="math inline">\(1-\alpha=0.95\)</span> .<br />
In the simulation result of Example 6.4 , the estimated coverage probability is <span class="math inline">\(\hat{P}=\)</span> 0.9513 , which roughly equals to the confidence level .<br />
Hence the results above substantiated that whether the distribution of sample population is identical to the theoriotical one has (significant) effect on the coverage probabilty (the real confidence level) .</p>
</div>
</div>
<div id="section-11" class="section level2">
<h2>6.6</h2>
<div id="basic-idea-7" class="section level3">
<h3>(1) Basic idea</h3>
<p>The definition of sample skewness of a population <span class="math inline">\(X\)</span> with sample <span class="math inline">\(X_1,\ldots,X_n\)</span> is <span class="math display">\[\sqrt{b_{1}}=\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}\]</span> In the answer below , samples to calculate skewnesses are generated form population <span class="math inline">\(N(0,1)\)</span> . According to formula (2.14) , under normality approximation , the standard error of the estimated <span class="math inline">\(\alpha\)</span>-quantiles is <span class="math display">\[sd(\sqrt{b_{1}}_\alpha)=\sqrt\frac{\alpha(1-\alpha)}{nf(x_\alpha)^2}\]</span> where <span class="math inline">\(f\)</span> is the density function of <span class="math inline">\(N(0,6/n)\)</span> .<br />
 <br />
In each MC experiment , generate <span class="math inline">\(n\times k\)</span> normal samples to calculate <span class="math inline">\(k\)</span> skewnesses <span class="math inline">\(\sqrt{b_1}_i\ ,\ i=1,\ldots,k\)</span> .<br />
Then , calculate the quatiles of skewnesses : <span class="math inline">\(\hat{q}_{\alpha}^{(j)}\ ,\ j=1,\ldots,m\)</span> .<br />
Repeat MC experiment for <span class="math inline">\(m\)</span> times , and the MC estimate for each quantile is <span class="math display">\[\hat{q}_\alpha^{MC}=\frac{1}{m}\sum\limits_{j=1}^m\hat{q}_\alpha^{(j)}\]</span></p>
</div>
<div id="code-and-output-3" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># Sampling</span></a>
<a class="sourceLine" id="cb32-2" title="2">n&lt;-<span class="dv">50</span> <span class="co"># Sample size to calculate skewness</span></a>
<a class="sourceLine" id="cb32-3" title="3">k&lt;-<span class="dv">300</span> <span class="co"># Number of skewnesses to calculate their quantile</span></a>
<a class="sourceLine" id="cb32-4" title="4">m&lt;-<span class="dv">10000</span> <span class="co"># Times to repeat MC experiment</span></a>
<a class="sourceLine" id="cb32-5" title="5"></a>
<a class="sourceLine" id="cb32-6" title="6">a&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>) <span class="co"># alpha of quantiles</span></a>
<a class="sourceLine" id="cb32-7" title="7"></a>
<a class="sourceLine" id="cb32-8" title="8">moment&lt;-<span class="cf">function</span>(x,n){  <span class="co"># Function to calculate central moment</span></a>
<a class="sourceLine" id="cb32-9" title="9">  y&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span>n)</a>
<a class="sourceLine" id="cb32-10" title="10">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb32-11" title="11">}</a>
<a class="sourceLine" id="cb32-12" title="12"></a>
<a class="sourceLine" id="cb32-13" title="13">quantile.sk&lt;-<span class="cf">function</span>(n,k){ <span class="co"># Function to calculate the quantile of skewness</span></a>
<a class="sourceLine" id="cb32-14" title="14">  x&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb32-15" title="15">  skewness&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb32-16" title="16">  </a>
<a class="sourceLine" id="cb32-17" title="17">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb32-18" title="18">    x[i,]&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># Samples to calculate skewness</span></a>
<a class="sourceLine" id="cb32-19" title="19">    skewness[i]&lt;-<span class="kw">moment</span>(x[i,],<span class="dv">3</span>)<span class="op">/</span>(<span class="kw">moment</span>(x[i,],<span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb32-20" title="20">  }</a>
<a class="sourceLine" id="cb32-21" title="21">  q.est&lt;-<span class="kw">quantile</span>(skewness,a) <span class="co"># Quantiles of skewness</span></a>
<a class="sourceLine" id="cb32-22" title="22">  <span class="kw">return</span>(q.est)</a>
<a class="sourceLine" id="cb32-23" title="23">}</a>
<a class="sourceLine" id="cb32-24" title="24"></a>
<a class="sourceLine" id="cb32-25" title="25">q.est&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>m,<span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb32-26" title="26"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) q.est[j,]&lt;-<span class="kw">quantile.sk</span>(n,k) <span class="co"># m times of MC experiments for m quantiles</span></a>
<a class="sourceLine" id="cb32-27" title="27"></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="co"># Estimation</span></a>
<a class="sourceLine" id="cb32-29" title="29">sd.sample&lt;-<span class="kw">apply</span>(q.est,<span class="dv">2</span>,sd) <span class="co"># Actual standard error of quantiles</span></a>
<a class="sourceLine" id="cb32-30" title="30">sd.formula&lt;-<span class="kw">sqrt</span>(a<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(<span class="kw">qnorm</span>(a,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)),<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="op">^</span><span class="dv">2</span>)) <span class="co"># Standard error calculated with the formula</span></a>
<a class="sourceLine" id="cb32-31" title="31"><span class="kw">rbind</span>(sd.sample,sd.formula)</a></code></pre></div>
<pre><code>##                  [,1]       [,2]       [,3]       [,4]
## sd.sample  0.05434788 0.04221437 0.04217648 0.05429742
## sd.formula 0.13086697 0.10352462 0.10352462 0.13086697</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">q.hat&lt;-<span class="kw">colMeans</span>(q.est) <span class="co"># MC estimates of quantiles</span></a>
<a class="sourceLine" id="cb34-2" title="2">q.norm&lt;-<span class="kw">qnorm</span>(a,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) <span class="co"># Large sample approximation</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw">rbind</span>(q.hat,q.norm)</a></code></pre></div>
<pre><code>##              [,1]       [,2]      [,3]      [,4]
## q.hat  -0.6362521 -0.5279729 0.5274298 0.6356341
## q.norm -0.6789514 -0.5697940 0.5697940 0.6789514</code></pre>
</div>
<div id="comparison-2" class="section level3">
<h3>(3) Comparison</h3>
<p>Through formula (2.14) , the calculated standard variances of <span class="math inline">\(\sqrt{b_{1}}_\alpha\)</span> are slightly larger than sample standard variance .<br />
 <br />
Accoring to the output , the MC estimates of quantiles are respectively -0.6362521, -0.5279729, 0.5274298, 0.6356341 , while the quantiles under large sample approximation are respectively -0.6789514, -0.569794, 0.569794, 0.6789514 . The approximated ones are a little larger than corresponding etimated ones .</p>
</div>
</div>
</div>
<div id="section-12" class="section level1">
<h1>2019-11-1</h1>
<div id="section-13" class="section level2">
<h2>6.7</h2>
<div id="basic-idea-8" class="section level3">
<h3>(1) Basic idea</h3>
<p>Classical skewness test for symmetricity can be characterized as: <span class="math display">\[H_0:\sqrt{\beta _1}=0\longleftrightarrow H_1:\sqrt{\beta _1}\neq0\]</span></p>
<p>While in this question the test is applied to test normality: <span class="math display">\[H_0:X\sim N(\mu,\sigma^2)\longleftrightarrow H_1:X\nsim N(\mu,\sigma^2)\]</span> And the test statistic is still sample skewness <span class="math inline">\(\sqrt{b_1}\)</span>. Under normality assumption (namely, <span class="math inline">\(H_0\)</span>), <span class="math inline">\(\sqrt{b_1} \stackrel{d}\rightarrow N(0,6/n)\)</span> as <span class="math inline">\(n\rightarrow \infty\)</span><br />
Thus, having fixed significance level <span class="math inline">\(\alpha\)</span> , reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|\sqrt{b_1}|&gt;z_{\alpha/2}(0,6/n)\)</span>, where <span class="math inline">\(z_{\alpha/2}(0,6/n)\)</span> represents the upper <span class="math inline">\(\alpha/2\)</span> quantile for <span class="math inline">\(N(0,6/n)\)</span></p>
<p>The power of the test against non-normal population can be estimated through Monte Carlo experiment.<br />
For simplicity, target parameter <span class="math inline">\(\alpha\)</span> for both Beta<span class="math inline">\((\alpha,\alpha)\)</span> and <span class="math inline">\(v\)</span> for <span class="math inline">\(t(v)\)</span> range within {5,10,15,20,25}.</p>
</div>
<div id="code-and-output-4" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># Sample skewness function</span></a>
<a class="sourceLine" id="cb36-2" title="2">sk&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb36-3" title="3">  m3&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb36-4" title="4">  m2&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb36-5" title="5">  y&lt;-m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb36-6" title="6">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb36-7" title="7">}</a>
<a class="sourceLine" id="cb36-8" title="8"></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co"># Generate sample from Beta and t</span></a>
<a class="sourceLine" id="cb36-10" title="10">n&lt;-<span class="dv">200</span> <span class="co"># Sample size</span></a>
<a class="sourceLine" id="cb36-11" title="11">m&lt;-<span class="dv">5000</span> <span class="co"># Replication of MC experiment</span></a>
<a class="sourceLine" id="cb36-12" title="12">theta&lt;-<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>) <span class="co"># Parameters</span></a>
<a class="sourceLine" id="cb36-13" title="13"></a>
<a class="sourceLine" id="cb36-14" title="14">p1&lt;-p2&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb36-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> theta){</a>
<a class="sourceLine" id="cb36-16" title="16">  R1&lt;-R2&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb36-17" title="17">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb36-18" title="18">    x1&lt;-<span class="kw">rbeta</span>(n,i,i)</a>
<a class="sourceLine" id="cb36-19" title="19">    x2&lt;-<span class="kw">rt</span>(n,i)</a>
<a class="sourceLine" id="cb36-20" title="20">    b1&lt;-<span class="kw">sk</span>(x1)</a>
<a class="sourceLine" id="cb36-21" title="21">    b2&lt;-<span class="kw">sk</span>(x2)</a>
<a class="sourceLine" id="cb36-22" title="22">    z&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb36-23" title="23">    R1[j]&lt;-<span class="kw">mean</span>(<span class="kw">abs</span>(b1)<span class="op">&gt;</span>z)</a>
<a class="sourceLine" id="cb36-24" title="24">    R2[j]&lt;-<span class="kw">mean</span>(<span class="kw">abs</span>(b2)<span class="op">&gt;</span>z)</a>
<a class="sourceLine" id="cb36-25" title="25">  }</a>
<a class="sourceLine" id="cb36-26" title="26">  p1[i<span class="op">/</span><span class="dv">5</span>]&lt;-<span class="kw">mean</span>(R1)</a>
<a class="sourceLine" id="cb36-27" title="27">  p2[i<span class="op">/</span><span class="dv">5</span>]&lt;-<span class="kw">mean</span>(R2)</a>
<a class="sourceLine" id="cb36-28" title="28">}</a>
<a class="sourceLine" id="cb36-29" title="29"></a>
<a class="sourceLine" id="cb36-30" title="30"><span class="co"># Power curve</span></a>
<a class="sourceLine" id="cb36-31" title="31"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb36-32" title="32"><span class="kw">plot</span>(theta,p1,<span class="dt">xlab=</span><span class="st">&quot;a&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Beta(a,a)&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb36-33" title="33"><span class="kw">plot</span>(theta,p2,<span class="dt">xlab=</span><span class="st">&quot;v&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;t(v)&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmZmZmkNtmtttmtv+QOgCQZjqQkDqQkLaQttuQ2/+2ZgC2Zjq2ZpC2kGa225C22/+2/7a2/9u2///bkDrbtpDb27bb2//b////tmb/25D/27b//7b//9v///86ahJ1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJiUlEQVR4nO2da2PbNBiF1QstMGBhwDqg4TKYN5Iuyf//dViS7TiJ5fPKeqV69Xk+0NoJ0tljWbJVX8yBjGKeO8DcoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBTBFXGc/X9+7NP9n9+OF2xW109jpT0dH/9YeTjdHygsxRRtaYIMuasos9vzmuuzO1mpKT9g3k9IYCYJtBZiqha0wSdVbQ+NwajAIGp+EAXKWJqnSbIe3i6N3f1j/0f9d72w8bG8Y3q45v65yvbqLfGte3jCs9xuS7i7YQEQppALkWz8bamrjCm1hRBH+/tltmtXFu6+XDM43uox/abvRWO3nL9P2fcx5pALoUzY1fVjSem1rRd7Na1m+v3dpu8blp03aC/2vgV9a93h/4Kx8nyOus+1gbyKe66DRJRa5Kgq1+6Kt1W6vqgT399Y+o89Wd3h/6Kjm75ottSxZXepHAJK9+OI2pN7qTrltDtMU2f+M6vuGtbyXGFp79cmdHjgERcoCaF7XjqZuSaTkStKX3Q59WxxzkKqkOYm98+rTpBvRWOk+Vyguw+1u7nhQS5evojQi/P7iiot8JxslxOkI39a1NbqRb0UNdz/Ic3efxw4VL5aL0VjpPlgoJcZ+A75+yC+sPY2vbV9d5W/+rqrXPcbmp3XSfdW+H6gN5y7k7aBeo2oR313za/Feqkm0OZ9lfbH13/+2DaPrgbYHsrbje95dzDfBvorl1qvJQa5l+5k9XP7+q2685b7TH1zXs7SN383oyqNshxhR9Fel/IfDLmA7VnFl1Tiqk173TH9mJfX9+dLD7d5+yCQilias0rqN5Upyc9T/eny9u8J6uBFDG1Zp4wq8xJi9m/+/n083Xe6Y7hFFG1Zha0W40OF9knzAZTZJ8wWxQUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAggLIgE0S3nnJ5tAUVqkdKeh4KmlrCNChoWnHP2AeFPhCXoJRkpDhnh4JCxTURFy5oZPQ0mvVEMxdB4eJM6IMylBW0W9mLQ93V66GLICnoUNlLjHerwD2f58WZ0AeFMMFxVV6CHCuoUVMFrsSmoOZS+W1gJ6OguBZkQh+UorSg9iYm313j4hYm6OAcXT3WA1noXofFC4orzoQ+KAYFAUoLqtq7PivJKGZCH5SjsKDK3SLr7uamoAH2D/4GfXt/MwUN0J5grG83FDSEb0EHe2euRFBQVkGCU3WZ+qBGy24VOp9fuKB6FPM72f6BgqZBQRHFLVFQ+9gN0YziMwrqz5EX7aSPT7g5PVsdmrQPnnWUpKygbpgXzQctUFBvJlowo7hAQWxBiPYwKDxjtnBB7dOmwk+XecGCevtPWqDhBNGC9PIMVh0vKPi3wOhAgwmiBenlURIUHJgGwWfzqYLi8oRQbUEGHCVHFafQgrTyaLUgFRRbkArzFXRe7ksQtLNP01yPjh3yk1UFQYI8ENVO+uqxPj4O/lHZEjxZvSwuXZAgD0ZRkD3uqEb+XnGIO9VIFiTII0D5OMgGGhldY05WkwUJ8gjI0ILW4YdUPksLGsnTsDXhhx/r90HV2AsV5CerF/VP7YNG89gHIL9++m4DLgkcqnviKDayLY5fkZysKggS5LGta+2+MdqitQRpoCkI4trN09fuDSdjfeKCBblrBf47FGlB/WfTR3MxaZ8uSJKnOwQYvyRQqQX1Hr0+HcUWJMlT+U+3wZ5cfxcDzzcWFndZ/dRdTCOPniC70VRakJIgpTxKguxrJ5LnqBQFReUZncDT6qS1ZvAGq5/QSSfkOR00tHax5n1qSWjuYmp5FDvpyiS+ME65k9bJs+BRTDiBN1D5BEFrvUn7lEAxeaQTeCqC/F0YqegJEuQRT7/otCAVFFsQRjyBpyTIvX8rsRVpCoJ5CregbfNCtKRhQ1GQII90Ak9FULs5QtsipjgNQaI8wgk8pU7ab430SXKtTnoeeb7sFlQgzxfdB5XIk2MUSzq0z5BndsdBSoI0oCBA+rlh74tuzJzWJSrOv6jkOa9WRdDW/wXuuac4M+TREbR/6O63DH9bNr2gIkiUB6IoaPej31RjB2bC6QUVQZI8mAwtaOTATHpyqNqCNA4Ulfogd0g2dmAmnV5Q6oNgHgGau9jqOBQF/vXCFjRY95QJM5RHgDn7GZ8nKrhsekFHkA6FBcmmF5YsSFQcBYHi5ijoov6FC7q8yZiChikrSDDyLltQ+JEdJ8XNUtB5gEy72P4BXG9hQiUuRNDI1YBdccsWJCiOgkBxMxV0loCCLqotIkgyo7hkQaLH4yxYkGw+aK6CTiNkOpKWzCguWJCoBQUKXIQg0YziogVJZhTnKyhsS1xCOhQEi5uxoPCgLy5BTPjuGgoCxRUUJJzAG1xchCDhBN7g4jIEiSbwhpef7WQ1VF6mPkgwgTe8ovDJ6rG4woIQZQVJTjXmLij6lYLaJ6uzF3SIfCnlC2lBorc09FZnepVx1LNcE+pJ5vJPzxffEBcVVXHMs1xT6lGjtKDpxVEQKC7XgaLorueUPNqCgujW45Ecl6Xm0Q5uzv8bedgRg2BUTc/zJQsSHJctWxBbEAIfly1cED4uW7ogDAUBKAhAQYDZCXpxUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIICmID+/l/wMaDVU8mgK8u8AmQ8qeTQFqby2URG110hqUc1n73Ko5NEUtP623uU1Xh+rhEoeRUG7lf3rS+JLCRXRyaM+zL+0jkhd0NO9xiuI9UjNoy/ohY31ioL8tprPLqaTR3UUs8PqfDppnTyqu5h9FcaceiCNPDxZBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAbIJmtelMM3FVBNe+5tLkL14KfE1xJr4h75Oeetvrsey2Pfszul6Tvugxd1qwtVmGfug7Zz2Mfu0qil7WDZBlTHXf8+oBdl9ftJ7tTMJcnvXnHaxw/b6n9WUOJkEuYtv0cOei7Jb/TTpguCMLWi3mtOdLfVxx6SbfzL2QVeP6/mM85PbM4+kARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/mboHi8yOqpQAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="result-comment" class="section level3">
<h3>(3) Result comment</h3>
<p>According to the result, under <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distribution, the power is quite low but gradually increasing with <span class="math inline">\(\alpha\)</span>. While for <span class="math inline">\(X\sim t(v)\)</span>, the power is much larger but decreasong with <span class="math inline">\(v\)</span>.<br />
The empirical powers of the test in both two cases are much different. It can be infered that the asymptotic distribution of <span class="math inline">\(\sqrt{b_1}\)</span> deviates much form <span class="math inline">\(N(0,6/n)\)</span> under <span class="math inline">\(t\)</span> distribution, while not the same for <span class="math inline">\(Beta\)</span> distribution. Hence, we can conclude that the test is not applicable for all sample distribution.</p>
</div>
</div>
<div id="a" class="section level2">
<h2>6.A</h2>
<div id="basic-idea-9" class="section level3">
<h3>(1) Basic idea</h3>
<p>Denote the mean of a population as <span class="math inline">\(\mu\)</span> , the <span class="math inline">\(t\)</span>-test for whether <span class="math inline">\(\mu=\mu_0\)</span> can be characterized as: <span class="math display">\[H_0:\mu=\mu_0\longleftrightarrow H_1:\mu\neq\mu_0\]</span> Consider a test statistic: <span class="math display">\[T=\frac{\sqrt{n}(\bar{X}-\mu_0)}{S_X}\]</span> where <span class="math inline">\(S_X=\sqrt{\frac{1}{n-1}\sum\limits_{i=1}^n(X_i-\bar{X})^2}\)</span><br />
Under normality assumption and <span class="math inline">\(H_0\)</span> , <span class="math inline">\(T\sim t(n-1)\)</span><br />
Fix significance level <span class="math inline">\(\alpha\)</span> , reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|t|&gt;t_{\alpha/2}(n-1)\)</span><br />
 <br />
When sampling from different populations, the empirical type I error can be estimated respectively through Monte Carlo experiment.</p>
</div>
<div id="code-and-output-5" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">m&lt;-<span class="dv">10000</span> <span class="co"># Replications of MC experiment</span></a>
<a class="sourceLine" id="cb37-2" title="2">n&lt;-<span class="dv">100</span> <span class="co"># Sample size in each MC experiment</span></a>
<a class="sourceLine" id="cb37-3" title="3">u&lt;-<span class="dv">1</span> <span class="co"># Population means are equivalent</span></a>
<a class="sourceLine" id="cb37-4" title="4"></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="co"># Chisq(1)</span></a>
<a class="sourceLine" id="cb37-6" title="6">error.C&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb37-7" title="7">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-8" title="8">  t&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>u)<span class="op">/</span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb37-9" title="9">  reject&lt;-(<span class="kw">abs</span>(t)<span class="op">&gt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb37-10" title="10">})</a>
<a class="sourceLine" id="cb37-11" title="11">Chi.rate&lt;-<span class="kw">mean</span>(error.C)</a>
<a class="sourceLine" id="cb37-12" title="12"></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="co"># U(0,2)</span></a>
<a class="sourceLine" id="cb37-14" title="14">error.U&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb37-15" title="15">  x&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-16" title="16">  t&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>u)<span class="op">/</span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb37-17" title="17">  reject&lt;-(<span class="kw">abs</span>(t)<span class="op">&gt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb37-18" title="18">})</a>
<a class="sourceLine" id="cb37-19" title="19">U.rate&lt;-<span class="kw">mean</span>(error.U)</a>
<a class="sourceLine" id="cb37-20" title="20"></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="co"># Exp(1)</span></a>
<a class="sourceLine" id="cb37-22" title="22">error.E&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb37-23" title="23">  x&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-24" title="24">  t&lt;-<span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span>u)<span class="op">/</span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb37-25" title="25">  reject&lt;-(<span class="kw">abs</span>(t)<span class="op">&gt;</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb37-26" title="26">})</a>
<a class="sourceLine" id="cb37-27" title="27">Exp.rate&lt;-<span class="kw">mean</span>(error.E)</a>
<a class="sourceLine" id="cb37-28" title="28"></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="kw">cbind</span>(Chi.rate,U.rate,Exp.rate)</a></code></pre></div>
<pre><code>##      Chi.rate U.rate Exp.rate
## [1,]   0.0649 0.0523   0.0578</code></pre>
</div>
<div id="result-comment-1" class="section level3">
<h3>(3) Result comment</h3>
<p>According to the result, in each case, the empirical Type I error is only slightly different form nominal level, which substantiates that the <span class="math inline">\(t\)</span>-test is robust to mild departures from normality.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Consider a single parameter hypothesis test problem : <span class="math display">\[H_0^*:\theta\in\Theta_0\longleftrightarrow H_1^*:\theta\in\Theta_1\]</span> The power of a method is defined as <span class="math display">\[\beta=P(p\leq \alpha|H_1^*)\]</span> where <span class="math inline">\(p\)</span> represent the <span class="math inline">\(p\)</span>-value of the test method, <span class="math inline">\(\alpha\)</span> is the significance level.</p>
<p>* To test if two test methods have different power, denote their <span class="math inline">\(p\)</span>-value as <span class="math inline">\(p_1\)</span> , <span class="math inline">\(p_2\)</span> , the corresponding hypothesis test problem can then be characterized as <span class="math display">\[H_0:P(p_1\leq \alpha|H_1^*)=P(p_2\leq \alpha|H_1^*)\longleftrightarrow H_1:P(p_1\leq \alpha|H_1^*)\neq P(p_2\leq \alpha|H_1^*)\]</span> Intuitively, the essence of this test problem is to test if the conditional distribution function values of <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are equivalent at <span class="math inline">\(\alpha\)</span>, conditional on <span class="math inline">\(H_1\)</span>.</p>
<p>* Moreover, the test problem can be interpreted as <span class="math display">\[H_0:E(I(p_1\leq\alpha)|H_1^*)=E(I(p_2\leq\alpha)|H_1^*)\longleftrightarrow H_1:E(I(p_1\leq\alpha)|H_1^*)\neq E(I(p_2\leq\alpha)|H_1^*)\]</span> Since <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(H_1^*\)</span> are fixed, notice that <span class="math inline">\(I(p_1\leq\alpha)\ ,\ I(p_2\leq\alpha)\)</span> are independent and <span class="math display">\[I(p_1\leq\alpha)\sim B(1,P(p_1\leq\alpha|H_1^*))\ ,\ I(p_2\leq\alpha)\sim B(1,P(p_2\leq\alpha|H_1^*))\]</span> conditional on <span class="math inline">\(H_1\)</span>, this is a test of mean between two Bernoulli populations.</p>
<p>* In this question, 10,000 MC experiments were conducted, each experiment gives two samples from two Bernoulli populations respectively. Since the sample size are quite large: n=10000, we can use large sample approximation for the test. In other word, we resort to Z-test.</p>
<p>* Hence, we have the ultimate result for this question:<br />
<span class="math inline">\((1)\)</span> Population: <span class="math display">\[X\sim B(1,\mu_1)\ ,\ Y\sim B(1,\mu_2)\]</span> where <span class="math inline">\(\mu_1=P(p_1\leq\alpha|H_1^*)\ ,\ ,\mu_2=P(p_2\leq\alpha|H_1^*)\)</span></p>
<p><span class="math inline">\((2)\)</span> Hypothesis test problem: <span class="math display">\[H_0:\mu_1=\mu_2\longleftrightarrow H_1:\mu_1\neq\mu_2\]</span></p>
<p><span class="math inline">\((3)\)</span> Test method: Z-test<br />
Under <span class="math inline">\(H_0\)</span>, the estimation for <span class="math inline">\(\mu\stackrel{\Delta}=\mu_1=\mu_2\)</span> is <span class="math inline">\(\hat{\mu}=\frac{\sum_i X_i+\sum_j Y_j}{2n}=\frac{\bar{X}+\bar{Y}}{2}\)</span>.<br />
According to CLT and Slutsky theorem, under <span class="math inline">\(H_0\)</span>, the Z-test statistic: <span class="math display">\[Z=\sqrt{\frac{n\times n}{n+n}} \frac{\bar{X}-\bar{Y}}{\hat{\mu}(1-\hat{\mu})}=\sqrt{\frac{n}{2}} \frac{\bar{X}-\bar{Y}}{\hat{\mu}(1-\hat{\mu})}\stackrel{d}\longrightarrow N(0,1)\quad \text{as}\quad n\rightarrow\infty\]</span> Fix significance level <span class="math inline">\(\alpha&#39;=0.05\)</span>, reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|Z|&gt;z_{\alpha&#39;/2}\)</span></p>
<p><span class="math inline">\((4)\)</span> Needed information:<br />
<span class="math inline">\(n\ ,\ \bar{X}\)</span> and <span class="math inline">\(\bar{Y}\)</span>, which is already given in the question that <span class="math inline">\(n=10000\ ,\ \bar{X}=0.651\)</span> and <span class="math inline">\(\bar{Y}=0.676\)</span>.</p>
<p><span class="math inline">\((5)\)</span> Test result:<br />
It can be calculated that <span class="math inline">\(z=7.9177&gt;1.96=z_{0.025}\)</span>, thus we reject <span class="math inline">\(H_0\)</span> and deem that the powers are different.</p>
</div>
</div>
<div id="section-14" class="section level1">
<h1>2019-11-8</h1>
<div id="section-15" class="section level2">
<h2>7.6</h2>
<div id="code-and-result-1" class="section level3">
<h3>Code and result</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb39-2" title="2">x&lt;-scor</a>
<a class="sourceLine" id="cb39-3" title="3">Corr=<span class="kw">cor</span>(x) <span class="co"># Corrlation.hat</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="kw">print</span>(Corr)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">plot</span>(x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb42-2" title="2">B&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb42-3" title="3">Corr.star&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>B,<span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb42-4" title="4"></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb42-6" title="6">index&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb42-7" title="7">x.star&lt;-x[index,] <span class="co"># Bootstrap sample</span></a>
<a class="sourceLine" id="cb42-8" title="8">Cor&lt;-<span class="kw">cor</span>(x.star)</a>
<a class="sourceLine" id="cb42-9" title="9">Corr.star[i,]&lt;-<span class="kw">c</span>(Cor[<span class="dv">1</span>,<span class="dv">2</span>],Cor[<span class="dv">3</span>,<span class="dv">4</span>],Cor[<span class="dv">3</span>,<span class="dv">5</span>],Cor[<span class="dv">4</span>,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb42-10" title="10">}</a>
<a class="sourceLine" id="cb42-11" title="11"></a>
<a class="sourceLine" id="cb42-12" title="12">se.hat&lt;-<span class="kw">apply</span>(Corr.star,<span class="dv">2</span>,sd)</a>
<a class="sourceLine" id="cb42-13" title="13">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">value=</span>se.hat,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;se12.hat&quot;</span>,<span class="st">&quot;se34.hat&quot;</span>,<span class="st">&quot;se35.hat&quot;</span>,<span class="st">&quot;se45.hat&quot;</span>)))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>se12.hat</td>
<td align="right">0.0763236</td>
</tr>
<tr class="even">
<td>se34.hat</td>
<td align="right">0.0486994</td>
</tr>
<tr class="odd">
<td>se35.hat</td>
<td align="right">0.0596086</td>
</tr>
<tr class="even">
<td>se45.hat</td>
<td align="right">0.0684478</td>
</tr>
</tbody>
</table>
<p>According to the correlation matrix, each pair of test scores are positive correlated to different extent, which accords with the scatterplot.<br />
Bootstrap estimates of the standard errors for these estimators are small, indicating that they are accurate estimator for the correlation coefficients of the population.</p>
</div>
</div>
<div id="b" class="section level2">
<h2>7.B</h2>
<div id="basic-idea-10" class="section level3">
<h3>(1) Basic idea</h3>
<p>Consider normal population <span class="math inline">\(X\sim N(0,1)\)</span>, its skewness is <span class="math inline">\(\sqrt{\beta_1}_X=0\)</span>.<br />
While for <span class="math inline">\(\chi^2\)</span> population <span class="math inline">\(Y\sim\chi^2(5)\)</span>, its skewness is <span class="math inline">\(\sqrt{\beta_1}_Y=\frac{E(Y-EY)^3}{[Var(Y)]^{3/2}}=\sqrt{8/5}\)</span><br />
Fix confidence level <span class="math inline">\(1-\alpha=0.95\)</span>, calculation for empirical coverage rates is based on the two conclusions.</p>
</div>
<div id="code-and-result-2" class="section level3">
<h3>(2) Code and result</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n&lt;-<span class="dv">100</span> <span class="co"># Sample size</span></a>
<a class="sourceLine" id="cb43-2" title="2">M&lt;-<span class="fl">1e3</span> <span class="co"># Repeats for MC experiments</span></a>
<a class="sourceLine" id="cb43-3" title="3">B&lt;-<span class="fl">1e3</span> <span class="co"># Times of Bootstrap experiments in each MC experiment</span></a>
<a class="sourceLine" id="cb43-4" title="4"></a>
<a class="sourceLine" id="cb43-5" title="5">skew&lt;-<span class="cf">function</span>(x){ <span class="co"># Function to calculate sample skewness</span></a>
<a class="sourceLine" id="cb43-6" title="6">  m3&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-7" title="7">  m2&lt;-<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-8" title="8">  y&lt;-m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb43-9" title="9">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb43-10" title="10">}</a>
<a class="sourceLine" id="cb43-11" title="11"></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb43-13" title="13">I.normal&lt;-I.basic&lt;-I.percentile&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>M,<span class="dt">ncol=</span><span class="dv">2</span>) <span class="co"># Coverage indicator</span></a>
<a class="sourceLine" id="cb43-14" title="14"></a>
<a class="sourceLine" id="cb43-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){</a>
<a class="sourceLine" id="cb43-16" title="16">  x&lt;-<span class="kw">rnorm</span>(n) <span class="co"># Normal population</span></a>
<a class="sourceLine" id="cb43-17" title="17">  y&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>) <span class="co"># Chisquare population</span></a>
<a class="sourceLine" id="cb43-18" title="18">  skew.x&lt;-<span class="kw">skew</span>(x)</a>
<a class="sourceLine" id="cb43-19" title="19">  skew.y&lt;-<span class="kw">skew</span>(y)</a>
<a class="sourceLine" id="cb43-20" title="20">  skstar.x&lt;-skstar.y&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb43-21" title="21">  </a>
<a class="sourceLine" id="cb43-22" title="22">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb43-23" title="23">    x.star&lt;-<span class="kw">sample</span>(x,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-24" title="24">    y.star&lt;-<span class="kw">sample</span>(y,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-25" title="25">    skstar.x[j]&lt;-<span class="kw">skew</span>(x.star)</a>
<a class="sourceLine" id="cb43-26" title="26">    skstar.y[j]&lt;-<span class="kw">skew</span>(y.star)</a>
<a class="sourceLine" id="cb43-27" title="27">  }</a>
<a class="sourceLine" id="cb43-28" title="28">  </a>
<a class="sourceLine" id="cb43-29" title="29">  x.n&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(skstar.x)</a>
<a class="sourceLine" id="cb43-30" title="30">  y.n&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sd</span>(skstar.y)</a>
<a class="sourceLine" id="cb43-31" title="31">  </a>
<a class="sourceLine" id="cb43-32" title="32">  x.b&lt;-<span class="kw">quantile</span>(skstar.x,<span class="kw">c</span>(<span class="fl">0.975</span>,<span class="fl">0.025</span>))</a>
<a class="sourceLine" id="cb43-33" title="33">  y.b&lt;-<span class="kw">quantile</span>(skstar.y,<span class="kw">c</span>(<span class="fl">0.975</span>,<span class="fl">0.025</span>))</a>
<a class="sourceLine" id="cb43-34" title="34">  </a>
<a class="sourceLine" id="cb43-35" title="35">  I.normal[i,]&lt;-<span class="kw">c</span>((skew.x<span class="op">-</span>x.n)<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="dv">0</span><span class="op">&lt;=</span>(skew.x<span class="op">+</span>x.n),</a>
<a class="sourceLine" id="cb43-36" title="36">                  (skew.y<span class="op">-</span>y.n)<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&lt;=</span>(skew.y<span class="op">+</span>y.n))</a>
<a class="sourceLine" id="cb43-37" title="37">  </a>
<a class="sourceLine" id="cb43-38" title="38">  I.basic[i,]&lt;-<span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>skew.x<span class="op">-</span>x.b[<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="dv">0</span><span class="op">&lt;=</span><span class="dv">2</span><span class="op">*</span>skew.x<span class="op">-</span>x.b[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb43-39" title="39">                 <span class="dv">2</span><span class="op">*</span>skew.y<span class="op">-</span>y.b[<span class="dv">1</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&lt;=</span><span class="dv">2</span><span class="op">*</span>skew.y<span class="op">-</span>y.b[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb43-40" title="40">  </a>
<a class="sourceLine" id="cb43-41" title="41">  I.percentile[i,]&lt;-<span class="kw">c</span>(x.b[<span class="dv">2</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="dv">0</span><span class="op">&lt;=</span>x.b[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb43-42" title="42">                      y.b[<span class="dv">2</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)<span class="op">&lt;=</span>y.b[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb43-43" title="43">}</a>
<a class="sourceLine" id="cb43-44" title="44"></a>
<a class="sourceLine" id="cb43-45" title="45">prob.hat&lt;-<span class="kw">rbind</span>(<span class="kw">colMeans</span>(I.normal),<span class="kw">colMeans</span>(I.basic),<span class="kw">colMeans</span>(I.percentile))</a>
<a class="sourceLine" id="cb43-46" title="46"><span class="kw">colnames</span>(prob.hat)&lt;-<span class="kw">c</span>(<span class="st">&quot;N(0,1)&quot;</span>,<span class="st">&quot;Chisquare(5)&quot;</span>)</a>
<a class="sourceLine" id="cb43-47" title="47">out&lt;-<span class="kw">as.data.frame</span>(prob.hat,row.names&lt;-<span class="kw">c</span>(<span class="st">&quot;Normal&quot;</span>,<span class="st">&quot;Basic&quot;</span>,<span class="st">&quot;Percentile&quot;</span>))</a>
<a class="sourceLine" id="cb43-48" title="48">knitr<span class="op">::</span><span class="kw">kable</span>(out)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">N(0,1)</th>
<th align="right">Chisquare(5)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Normal</td>
<td align="right">0.925</td>
<td align="right">0.761</td>
</tr>
<tr class="even">
<td>Basic</td>
<td align="right">0.907</td>
<td align="right">0.711</td>
</tr>
<tr class="odd">
<td>Percentile</td>
<td align="right">0.933</td>
<td align="right">0.737</td>
</tr>
</tbody>
</table>
<p>It can be inferred from the result that the coverage probabilties of bootstrap confidence intervals are roughly close to nominal confidence level under normal population.<br />
While they may be of quite low reliability for <span class="math inline">\(\chi^2\)</span> population, as the empirical coverage rates deviate much from confidence level.</p>
</div>
</div>
</div>
<div id="section-16" class="section level1">
<h1>2019-11-15</h1>
<div id="section-17" class="section level2">
<h2>7.8</h2>
<div id="basic-idea-11" class="section level3">
<h3>(1) Basic idea</h3>
<p>The original question asked for the MLE of <span class="math inline">\(\theta\)</span>, but it’s not available because the (joint) distribution of variables: <span class="math inline">\(X_1,\ldots,X_5\)</span> is completely unknown. Thus, in the answer below, <span class="math inline">\(\hat{\theta}\)</span> is obtained through sample covariance matrix.<br />
Calculate ordinary estimation of <span class="math inline">\(\theta\)</span>, denoted as <span class="math inline">\(\hat{\theta}\)</span>.<br />
Obtain the jackknife estimation of covariance matrix <span class="math inline">\(\hat{\Sigma}_{(i)}\)</span>, and <span class="math inline">\(\hat{\theta}_{(i)}\)</span>.<br />
Calculate the jackknife estimation of bias and sd : <span class="math display">\[\hat{bias}_{jack}=(n-1)(\bar{\hat{\theta}}_{(\cdot)}-\hat{\theta})\]</span> <span class="math display">\[\hat{sd}_{jack}=\sqrt{\frac{n-1}{n}\sum\limits_{i=1}^n(\bar{\hat{\theta}}_{(\cdot)}-\hat{\theta}_{(i)})^2}\]</span></p>
</div>
<div id="code-and-output-6" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb44-2" title="2">x&lt;-scor</a>
<a class="sourceLine" id="cb44-3" title="3">n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb44-4" title="4">lambda.hat&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb44-5" title="5">theta.hat&lt;-lambda.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda.hat)</a>
<a class="sourceLine" id="cb44-6" title="6"></a>
<a class="sourceLine" id="cb44-7" title="7">theta&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb44-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb44-9" title="9">  Cov&lt;-<span class="kw">cov</span>(x[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb44-10" title="10">  lambda&lt;-<span class="kw">eigen</span>(Cov)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb44-11" title="11">  theta[i]&lt;-lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb44-12" title="12">}</a>
<a class="sourceLine" id="cb44-13" title="13"></a>
<a class="sourceLine" id="cb44-14" title="14">theta.jack&lt;-<span class="kw">mean</span>(theta)</a>
<a class="sourceLine" id="cb44-15" title="15">bias.jack&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(theta.jack<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb44-16" title="16">var.jack&lt;-<span class="kw">var</span>(theta)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb44-17" title="17">sd.jack&lt;-<span class="kw">sqrt</span>(var.jack)</a>
<a class="sourceLine" id="cb44-18" title="18">out&lt;-<span class="kw">data.frame</span>(bias.jack,sd.jack)</a>
<a class="sourceLine" id="cb44-19" title="19"></a>
<a class="sourceLine" id="cb44-20" title="20">knitr<span class="op">::</span><span class="kw">kable</span>(out)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">bias.jack</th>
<th align="right">sd.jack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0010691</td>
<td align="right">0.0495523</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-18" class="section level2">
<h2>7.10</h2>
<div id="basic-idea-12" class="section level3">
<h3>(1) Basic idea</h3>
<p>According to the text book, corresponding <span class="math inline">\(\hat{\sigma}^2_{\epsilon}\)</span>’s for linear, quadratic and exponential model are respectively: <span class="math display">\[\hat{\sigma}^2_1=19.55644\ ,\quad \hat{\sigma}^2_2=17.85248\ ,\quad \hat{\sigma}^2_3=18.44188\]</span> Since the result of leave-one-out is always determinate, when choosing model by cross validation, we only need to conduct it on the newly required one: qubic polynomial model, and compare the output with the result given in the textbook.<br />
However, when choosing model by adjusted <span class="math inline">\(R^2\)</span>, we need to fit all four models and make comparison among the adjusted <span class="math inline">\(R^2\)</span> statstics of these models.</p>
</div>
<div id="code-and-output-7" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">library</span>(lattice)</a>
<a class="sourceLine" id="cb47-2" title="2"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb47-3" title="3">n&lt;-<span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb47-4" title="4"></a>
<a class="sourceLine" id="cb47-5" title="5">e.qubic&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb47-6" title="6"></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb47-8" title="8">  x&lt;-chemical[<span class="op">-</span>i]</a>
<a class="sourceLine" id="cb47-9" title="9">  y&lt;-magnetic[<span class="op">-</span>i]</a>
<a class="sourceLine" id="cb47-10" title="10">  L.qubic&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb47-11" title="11">  <span class="kw">attach</span>(L.qubic)</a>
<a class="sourceLine" id="cb47-12" title="12">  e.qubic[i]&lt;-magnetic[i]<span class="op">-</span>(coefficients[<span class="dv">1</span>]<span class="op">+</span>coefficients[<span class="dv">2</span>]<span class="op">*</span>chemical[i]<span class="op">+</span>coefficients[<span class="dv">3</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>coefficients[<span class="dv">4</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb47-13" title="13">  <span class="kw">detach</span>(L.qubic)</a>
<a class="sourceLine" id="cb47-14" title="14">}</a>
<a class="sourceLine" id="cb47-15" title="15"></a>
<a class="sourceLine" id="cb47-16" title="16">d.qubic&lt;-<span class="kw">mean</span>(e.qubic<span class="op">^</span><span class="dv">2</span>) <span class="co"># error.hat for qubic polynomial model</span></a>
<a class="sourceLine" id="cb47-17" title="17"></a>
<a class="sourceLine" id="cb47-18" title="18">m.l&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical) <span class="co"># linear</span></a>
<a class="sourceLine" id="cb47-19" title="19">m.q&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)) <span class="co"># quadratic</span></a>
<a class="sourceLine" id="cb47-20" title="20">m.e&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical) <span class="co"># exponential</span></a>
<a class="sourceLine" id="cb47-21" title="21">m.qubic&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>)) <span class="co"># qubic</span></a>
<a class="sourceLine" id="cb47-22" title="22"></a>
<a class="sourceLine" id="cb47-23" title="23">error.hat&lt;-<span class="kw">data.frame</span>(<span class="dt">Linear=</span><span class="kw">c</span>(<span class="fl">19.55644</span>),<span class="dt">Quadratic=</span><span class="kw">c</span>(<span class="fl">17.85248</span>),</a>
<a class="sourceLine" id="cb47-24" title="24">                <span class="dt">Exponential=</span><span class="kw">c</span>(<span class="fl">18.44188</span>),<span class="dt">Qubic=</span>d.qubic)</a>
<a class="sourceLine" id="cb47-25" title="25"></a>
<a class="sourceLine" id="cb47-26" title="26">adj.R&lt;-<span class="kw">c</span>(<span class="kw">summary</span>(m.l)<span class="op">$</span>adj.r.squared, <span class="co"># Linear model</span></a>
<a class="sourceLine" id="cb47-27" title="27">         <span class="kw">summary</span>(m.q)<span class="op">$</span>adj.r.squared, <span class="co"># Quadratic model</span></a>
<a class="sourceLine" id="cb47-28" title="28">         <span class="kw">summary</span>(m.e)<span class="op">$</span>adj.r.squared, <span class="co"># Exponential model</span></a>
<a class="sourceLine" id="cb47-29" title="29">         <span class="kw">summary</span>(m.qubic)<span class="op">$</span>adj.r.squared) <span class="co"># Qubic polynomial model</span></a>
<a class="sourceLine" id="cb47-30" title="30"></a>
<a class="sourceLine" id="cb47-31" title="31">out&lt;-<span class="kw">rbind</span>(error.hat,adj.R)</a>
<a class="sourceLine" id="cb47-32" title="32"><span class="kw">row.names</span>(out)&lt;-<span class="kw">c</span>(<span class="st">&quot;Cross validation&quot;</span>,<span class="st">&quot;Adjusted R square&quot;</span>)</a>
<a class="sourceLine" id="cb47-33" title="33">knitr<span class="op">::</span><span class="kw">kable</span>(out)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Linear</th>
<th align="right">Quadratic</th>
<th align="right">Exponential</th>
<th align="right">Qubic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cross validation</td>
<td align="right">19.5564400</td>
<td align="right">17.8524800</td>
<td align="right">18.4418800</td>
<td align="right">18.1775605</td>
</tr>
<tr class="even">
<td>Adjusted R square</td>
<td align="right">0.5281545</td>
<td align="right">0.5768151</td>
<td align="right">0.5280556</td>
<td align="right">0.5740396</td>
</tr>
</tbody>
</table>
<p>According to the result, the best model under cross validation is the quadratic model.<br />
Consider adjusted <span class="math inline">\(R^2\)</span>, the model selected is still the second one: quadratic model.</p>
</div>
</div>
</div>
<div id="section-19" class="section level1">
<h1>2019-11-22</h1>
<div id="section-20" class="section level2">
<h2>8.3</h2>
<div id="bsiac-idea" class="section level3">
<h3>(1) Bsiac idea</h3>
<p>For two population <span class="math inline">\(X,Y\)</span> satisfying <span class="math inline">\(EX=EY\)</span>, consider hypothesis test problem: <span class="math display">\[H_0:\sigma_X^2=\sigma_Y^2\longleftrightarrow H_1:\sigma_X^2\neq\sigma_Y^2\]</span> where <span class="math inline">\(\sigma_X^2=Var(X),\sigma_Y^2=Var(Y)\)</span>.<br />
Denote the Count 5 test statistic as <span class="math inline">\(T(X,Y)\)</span>. Intuitively, in each permutation test, we can use <span class="math inline">\(T(X^*,Y^*)\)</span> as an alternative statistic to preclude inequal sample size. Where <span class="math inline">\(X^*\)</span> is the one in <span class="math inline">\(X,Y\)</span> with larger sample size, <span class="math inline">\(Y^*=Z^*_1,\ldots,Z^*_{ \max \{ n,m \} }\)</span>.</p>
</div>
<div id="code-and-output-8" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Sample size</span></a>
<a class="sourceLine" id="cb48-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb48-3" title="3">m&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb48-4" title="4">N&lt;-n<span class="op">+</span>m</a>
<a class="sourceLine" id="cb48-5" title="5">n0&lt;-<span class="kw">max</span>(<span class="kw">c</span>(n,m))</a>
<a class="sourceLine" id="cb48-6" title="6"></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co"># MC experiment for permutation test</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co"># Equal variance</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb48-10" title="10">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-11" title="11">y1&lt;-<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-12" title="12">z1&lt;-<span class="kw">c</span>(x1,y1)</a>
<a class="sourceLine" id="cb48-13" title="13"></a>
<a class="sourceLine" id="cb48-14" title="14"><span class="co"># Unequal variance</span></a>
<a class="sourceLine" id="cb48-15" title="15">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb48-16" title="16">y2&lt;-<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb48-17" title="17">z2&lt;-<span class="kw">c</span>(x2,y2)</a>
<a class="sourceLine" id="cb48-18" title="18"></a>
<a class="sourceLine" id="cb48-19" title="19">count5test&lt;-<span class="cf">function</span>(x,y) {</a>
<a class="sourceLine" id="cb48-20" title="20">  X&lt;-x<span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb48-21" title="21">  Y&lt;-y<span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb48-22" title="22">  outx&lt;-<span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb48-23" title="23">  outy&lt;-<span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb48-24" title="24">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy))<span class="op">&gt;</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb48-25" title="25">}</a>
<a class="sourceLine" id="cb48-26" title="26"></a>
<a class="sourceLine" id="cb48-27" title="27">t1&lt;-x1  <span class="co"># The comparison is conducted between larger-sized pupulation</span></a>
<a class="sourceLine" id="cb48-28" title="28">t2&lt;-x2</a>
<a class="sourceLine" id="cb48-29" title="29"><span class="cf">if</span> (n<span class="op">&lt;</span>m) {</a>
<a class="sourceLine" id="cb48-30" title="30">  t1&lt;-y1</a>
<a class="sourceLine" id="cb48-31" title="31">  t2&lt;-y2</a>
<a class="sourceLine" id="cb48-32" title="32">}</a>
<a class="sourceLine" id="cb48-33" title="33"></a>
<a class="sourceLine" id="cb48-34" title="34">B&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb48-35" title="35">I1&lt;-I2&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb48-36" title="36"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb48-37" title="37">  k&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N,n0)</a>
<a class="sourceLine" id="cb48-38" title="38">  I1[i]&lt;-<span class="kw">count5test</span>(t1,z1[k])</a>
<a class="sourceLine" id="cb48-39" title="39">  I2[i]&lt;-<span class="kw">count5test</span>(t2,z2[k])</a>
<a class="sourceLine" id="cb48-40" title="40">}</a>
<a class="sourceLine" id="cb48-41" title="41"></a>
<a class="sourceLine" id="cb48-42" title="42">p1&lt;-<span class="kw">mean</span>(I1)</a>
<a class="sourceLine" id="cb48-43" title="43">p2&lt;-<span class="kw">mean</span>(I2)</a>
<a class="sourceLine" id="cb48-44" title="44">out&lt;-<span class="kw">cbind</span>(p1,p2)</a>
<a class="sourceLine" id="cb48-45" title="45"><span class="kw">colnames</span>(out)&lt;-<span class="kw">c</span>(<span class="st">&quot;Equal variace&quot;</span>,<span class="st">&quot;Unequal variance&quot;</span>)</a>
<a class="sourceLine" id="cb48-46" title="46">knitr<span class="op">::</span><span class="kw">kable</span>(out)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Equal variace</th>
<th align="right">Unequal variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0141</td>
<td align="right">0.0978</td>
</tr>
</tbody>
</table>
<p>It can be infered that the type I error rate is lower than before and is more close to the nominal level <span class="math inline">\(\alpha=0.05\)</span> through permutation. And it maintains power under <span class="math inline">\(H_1\)</span>.</p>
</div>
</div>
<div id="slide-p.31" class="section level2">
<h2>Slide p.31</h2>
<div id="basic-idea-13" class="section level3">
<h3>(1) Basic idea</h3>
<p>Since both two models indicate that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent, consider the independence test: <span class="math display">\[H_0:F_{XY}=F_XF_Y\longleftrightarrow H_1:F_{XY}\neq F_XF_Y\]</span> Intuitively, comparison between the power of the two methods can be conducted by calculating the porportion of rejection (empirical power).</p>
</div>
<div id="code-and-output-9" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># Necessary Function</span></a>
<a class="sourceLine" id="cb49-2" title="2">dCor&lt;-<span class="cf">function</span>(z,ix){</a>
<a class="sourceLine" id="cb49-3" title="3">n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb49-4" title="4"></a>
<a class="sourceLine" id="cb49-5" title="5">D&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb49-6" title="6">d&lt;-<span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb49-7" title="7">m&lt;-<span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb49-8" title="8">M&lt;-<span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb49-9" title="9">a&lt;-<span class="kw">sweep</span>(d,<span class="dv">1</span>,m)</a>
<a class="sourceLine" id="cb49-10" title="10">b&lt;-<span class="kw">sweep</span>(a,<span class="dv">2</span>,m)</a>
<a class="sourceLine" id="cb49-11" title="11"><span class="kw">return</span>(b<span class="op">+</span>M)</a>
<a class="sourceLine" id="cb49-12" title="12">}</a>
<a class="sourceLine" id="cb49-13" title="13"></a>
<a class="sourceLine" id="cb49-14" title="14">A&lt;-<span class="kw">D</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb49-15" title="15">B&lt;-<span class="kw">D</span>(z[ix,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb49-16" title="16">dCov&lt;-<span class="kw">sqrt</span>(<span class="kw">mean</span>(A<span class="op">*</span>B))</a>
<a class="sourceLine" id="cb49-17" title="17">dVarX&lt;-<span class="kw">sqrt</span>(<span class="kw">mean</span>(A<span class="op">*</span>A))</a>
<a class="sourceLine" id="cb49-18" title="18">dVarY&lt;-<span class="kw">sqrt</span>(<span class="kw">mean</span>(B<span class="op">*</span>B))</a>
<a class="sourceLine" id="cb49-19" title="19">dCor&lt;-<span class="kw">sqrt</span>(dCov<span class="op">/</span><span class="kw">sqrt</span>(dVarX<span class="op">*</span>dVarY))</a>
<a class="sourceLine" id="cb49-20" title="20"><span class="kw">return</span>(dCor)</a>
<a class="sourceLine" id="cb49-21" title="21">}</a>
<a class="sourceLine" id="cb49-22" title="22"></a>
<a class="sourceLine" id="cb49-23" title="23"><span class="co"># Testing</span></a>
<a class="sourceLine" id="cb49-24" title="24"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb49-25" title="25"><span class="kw">library</span>(mnormt)</a>
<a class="sourceLine" id="cb49-26" title="26"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">k&lt;-<span class="dv">15</span></a>
<a class="sourceLine" id="cb52-2" title="2">n&lt;-k<span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) <span class="co"># Sample size</span></a>
<a class="sourceLine" id="cb52-3" title="3">m&lt;-<span class="dv">99</span> <span class="co"># Times of permutation tests</span></a>
<a class="sourceLine" id="cb52-4" title="4">B&lt;-<span class="dv">100</span> <span class="co"># Times of MC experiments</span></a>
<a class="sourceLine" id="cb52-5" title="5">n0&lt;-<span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb52-6" title="6">pv1.dCor&lt;-pv2.dCor&lt;-pv1.ball&lt;-pv2.ball&lt;-<span class="kw">numeric</span>(n0) <span class="co"># Empirical power</span></a>
<a class="sourceLine" id="cb52-7" title="7"></a>
<a class="sourceLine" id="cb52-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> n){</a>
<a class="sourceLine" id="cb52-9" title="9">  x&lt;-<span class="kw">rmnorm</span>(i,<span class="dt">mean=</span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">varcov=</span><span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb52-10" title="10">  e&lt;-<span class="kw">rmnorm</span>(i,<span class="dt">mean=</span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">varcov=</span><span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb52-11" title="11">  y1&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb52-12" title="12">  y2&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e</a>
<a class="sourceLine" id="cb52-13" title="13">  z1&lt;-<span class="kw">cbind</span>(x,y1)</a>
<a class="sourceLine" id="cb52-14" title="14">  z2&lt;-<span class="kw">cbind</span>(x,y2)</a>
<a class="sourceLine" id="cb52-15" title="15">  </a>
<a class="sourceLine" id="cb52-16" title="16">  p1.dCor&lt;-p2.dCor&lt;-p1.ball&lt;-p2.ball&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb52-17" title="17">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb52-18" title="18">  out1.dCor&lt;-<span class="kw">boot</span>(z1,<span class="dt">statistic=</span>dCor,<span class="dt">R=</span>m,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>)</a>
<a class="sourceLine" id="cb52-19" title="19">  out2.dCor&lt;-<span class="kw">boot</span>(z2,<span class="dt">statistic=</span>dCor,<span class="dt">R=</span>m,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>)</a>
<a class="sourceLine" id="cb52-20" title="20">  I1&lt;-<span class="kw">c</span>(out1.dCor<span class="op">$</span>t0,out1.dCor<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb52-21" title="21">  I2&lt;-<span class="kw">c</span>(out2.dCor<span class="op">$</span>t0,out2.dCor<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb52-22" title="22">  </a>
<a class="sourceLine" id="cb52-23" title="23">  p1.dCor[j]&lt;-<span class="kw">mean</span>(I1<span class="op">&gt;=</span>out1.dCor<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb52-24" title="24">  p2.dCor[j]&lt;-<span class="kw">mean</span>(I2<span class="op">&gt;=</span>out2.dCor<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb52-25" title="25">  p1.ball[j]&lt;-<span class="kw">bcov.test</span>(x,y1,<span class="dt">R=</span>m,<span class="dt">seed=</span>i<span class="op">*</span>j)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb52-26" title="26">  p2.ball[j]&lt;-<span class="kw">bcov.test</span>(x,y2,<span class="dt">R=</span>m,<span class="dt">seed=</span>i<span class="op">*</span>j)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb52-27" title="27">  }</a>
<a class="sourceLine" id="cb52-28" title="28">  </a>
<a class="sourceLine" id="cb52-29" title="29">pv1.dCor[i<span class="op">/</span>k]&lt;-<span class="kw">mean</span>(p1.dCor<span class="op">&lt;</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb52-30" title="30">pv2.dCor[i<span class="op">/</span>k]&lt;-<span class="kw">mean</span>(p2.dCor<span class="op">&lt;</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb52-31" title="31">pv1.ball[i<span class="op">/</span>k]&lt;-<span class="kw">mean</span>(p1.ball<span class="op">&lt;</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb52-32" title="32">pv2.ball[i<span class="op">/</span>k]&lt;-<span class="kw">mean</span>(p2.ball<span class="op">&lt;</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb52-33" title="33">}</a>
<a class="sourceLine" id="cb52-34" title="34"></a>
<a class="sourceLine" id="cb52-35" title="35"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb52-36" title="36"><span class="kw">plot</span>(n,pv1.dCor,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Model 1&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-37" title="37"><span class="kw">lines</span>(n,pv1.ball,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb52-38" title="38"></a>
<a class="sourceLine" id="cb52-39" title="39"><span class="kw">plot</span>(n,pv2.dCor,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Power&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Model 2&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-40" title="40"><span class="kw">lines</span>(n,pv2.ball,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Accoding to the result, corresponding conclusion can be drawn that:<br />
(1) For model 1, it can be seen that distance correlation test is more powerful.<br />
(2) For model 2, ball statistic test is globally (in terms of sample size <span class="math inline">\(n\)</span>) powerful than distance correlation test.</p>
</div>
</div>
</div>
<div id="section-21" class="section level1">
<h1>2019-11-29</h1>
<div id="section-22" class="section level2">
<h2>9.4</h2>
<div id="basic-idea-14" class="section level3">
<h3>(1) Basic idea</h3>
<p>Target density: <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},\quad x\in R\]</span> Proposal density: <span class="math display">\[g(Y|X_t)=\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(Y-X_t)^2}{2\sigma^2}},\quad t=1,\ldots\]</span> where <span class="math inline">\(\sigma\in\{0.05,\ 0.5,\ 1,\ 5\}\)</span> and <span class="math inline">\(X_1\)</span> is set to be <span class="math inline">\(20\)</span>.</p>
</div>
<div id="code-and-output-10" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># Random walk Metropolis sampler</span></a>
<a class="sourceLine" id="cb53-2" title="2">rw&lt;-<span class="cf">function</span>(sigma,N){</a>
<a class="sourceLine" id="cb53-3" title="3">  x&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb53-4" title="4">  u&lt;-<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb53-5" title="5">  x[<span class="dv">1</span>]&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb53-6" title="6">  k&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb53-7" title="7">  </a>
<a class="sourceLine" id="cb53-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb53-9" title="9">    y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</a>
<a class="sourceLine" id="cb53-10" title="10">    </a>
<a class="sourceLine" id="cb53-11" title="11">    <span class="cf">if</span> (u[i]<span class="op">&lt;=</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))) {</a>
<a class="sourceLine" id="cb53-12" title="12">      x[i]&lt;-y</a>
<a class="sourceLine" id="cb53-13" title="13">      k&lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb53-14" title="14">    }</a>
<a class="sourceLine" id="cb53-15" title="15">    </a>
<a class="sourceLine" id="cb53-16" title="16">    <span class="cf">else</span> x[i]&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb53-17" title="17">  }</a>
<a class="sourceLine" id="cb53-18" title="18">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">rate=</span>k<span class="op">/</span>N))</a>
<a class="sourceLine" id="cb53-19" title="19">}</a>
<a class="sourceLine" id="cb53-20" title="20"></a>
<a class="sourceLine" id="cb53-21" title="21"><span class="co"># Sampling from different sigma</span></a>
<a class="sourceLine" id="cb53-22" title="22">sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb53-23" title="23">N&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb53-24" title="24">x&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb53-25" title="25"><span class="kw">length</span>(x)&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb53-26" title="26">rate&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb53-27" title="27"><span class="kw">set.seed</span>(<span class="dv">111</span>)</a>
<a class="sourceLine" id="cb53-28" title="28"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb53-29" title="29">  out&lt;-<span class="kw">rw</span>(sigma[i],N)</a>
<a class="sourceLine" id="cb53-30" title="30">  x[[i]]&lt;-out<span class="op">$</span>x</a>
<a class="sourceLine" id="cb53-31" title="31">  rate[i]&lt;-out<span class="op">$</span>rate</a>
<a class="sourceLine" id="cb53-32" title="32">}</a>
<a class="sourceLine" id="cb53-33" title="33"></a>
<a class="sourceLine" id="cb53-34" title="34">acc&lt;-<span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">Acceptance_rate=</span>rate)</a>
<a class="sourceLine" id="cb53-35" title="35">knitr<span class="op">::</span><span class="kw">kable</span>(acc)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">Acceptance_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">0.9822</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">0.8232</td>
</tr>
<tr class="odd">
<td align="right">1.00</td>
<td align="right">0.7072</td>
</tr>
<tr class="even">
<td align="right">5.00</td>
<td align="right">0.2848</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,x[[i]],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;σ=&quot;</span>,sigma[i]))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the graphs above, it can be infered that the chain converges rapidly even when <span class="math inline">\(\sigma\)</span> is small.</p>
</div>
</div>
</div>
<div id="section-23" class="section level1">
<h1>2019-12-6</h1>
<div id="section-24" class="section level2">
<h2>11.1</h2>
<p>For simplicity, fix <span class="math inline">\(x\in\{2,\ 2.1,\ \ldots\ ,\ 3\}\)</span> in the following answer.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">x&lt;-<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">y1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb55-3" title="3">y2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb55-4" title="4"></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="kw">all</span>(y1<span class="op">==</span>y2)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">all.equal</span>(y1,y2)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The output substantiated that the equality of the two function doesn’t hold in computer arithmetic. On the contrary, it holds with near equality.</p>
</div>
<div id="section-25" class="section level2">
<h2>11.5</h2>
<div id="code-and-output-11" class="section level3">
<h3>(1) Code and output</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">B&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb59-2" title="2">  g&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb59-3" title="3">    </a>
<a class="sourceLine" id="cb59-4" title="4">    f&lt;-<span class="cf">function</span>(u,k){</a>
<a class="sourceLine" id="cb59-5" title="5">      f&lt;-(k<span class="op">/</span>(k<span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="fl">0.5</span><span class="op">*</span>(k<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb59-6" title="6">      <span class="kw">return</span>(f)</a>
<a class="sourceLine" id="cb59-7" title="7">    }</a>
<a class="sourceLine" id="cb59-8" title="8">    </a>
<a class="sourceLine" id="cb59-9" title="9">    ck&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb59-10" title="10">    c&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)</a>
<a class="sourceLine" id="cb59-11" title="11">    I&lt;-<span class="kw">integrate</span>(f,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span>ck,<span class="dt">k=</span>k)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb59-12" title="12">    g&lt;-c<span class="op">*</span>I</a>
<a class="sourceLine" id="cb59-13" title="13">    <span class="kw">return</span>(g)</a>
<a class="sourceLine" id="cb59-14" title="14">  }</a>
<a class="sourceLine" id="cb59-15" title="15">  </a>
<a class="sourceLine" id="cb59-16" title="16">  <span class="kw">return</span>(<span class="kw">g</span>(a,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">g</span>(a,k))</a>
<a class="sourceLine" id="cb59-17" title="17">}</a>
<a class="sourceLine" id="cb59-18" title="18"></a>
<a class="sourceLine" id="cb59-19" title="19">k&lt;-<span class="kw">as.integer</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb59-20" title="20">ak&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb59-21" title="21"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)) ak[i]&lt;-<span class="kw">uniroot</span>(B,<span class="dt">lower=</span><span class="fl">0.01</span>,<span class="dt">upper=</span><span class="dv">2</span>,<span class="dt">k=</span>k[i])<span class="op">$</span>root</a></code></pre></div>
</div>
<div id="comparison-to-11.4" class="section level3">
<h3>(2) Comparison to 11.4</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">A&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb60-2" title="2">  sk&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb60-3" title="3">    ck&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb60-4" title="4">    sk&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(ck,k)</a>
<a class="sourceLine" id="cb60-5" title="5">  }</a>
<a class="sourceLine" id="cb60-6" title="6">  A&lt;-<span class="kw">sk</span>(a,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">sk</span>(a,k)</a>
<a class="sourceLine" id="cb60-7" title="7">  <span class="kw">return</span>(A)</a>
<a class="sourceLine" id="cb60-8" title="8">}</a>
<a class="sourceLine" id="cb60-9" title="9"></a>
<a class="sourceLine" id="cb60-10" title="10">Ak&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)) Ak[i]&lt;-<span class="kw">uniroot</span>(A,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k[i]<span class="op">-</span><span class="fl">0.01</span>)),<span class="dt">k=</span>k[i])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb60-12" title="12"></a>
<a class="sourceLine" id="cb60-13" title="13">out&lt;-<span class="kw">rbind</span>(k,<span class="kw">round</span>(Ak,<span class="dv">3</span>),<span class="kw">round</span>(ak,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb60-14" title="14"><span class="kw">row.names</span>(out)&lt;-<span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;A(k)&quot;</span>,<span class="st">&quot;a(k)&quot;</span>)</a>
<a class="sourceLine" id="cb60-15" title="15">out&lt;-<span class="kw">as.data.frame</span>(out)</a>
<a class="sourceLine" id="cb60-16" title="16">knitr<span class="op">::</span><span class="kw">kable</span>(out)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">V1</th>
<th align="right">V2</th>
<th align="right">V3</th>
<th align="right">V4</th>
<th align="right">V5</th>
<th align="right">V6</th>
<th align="right">V7</th>
<th align="right">V8</th>
<th align="right">V9</th>
<th align="right">V10</th>
<th align="right">V11</th>
<th align="right">V12</th>
<th align="right">V13</th>
<th align="right">V14</th>
<th align="right">V15</th>
<th align="right">V16</th>
<th align="right">V17</th>
<th align="right">V18</th>
<th align="right">V19</th>
<th align="right">V20</th>
<th align="right">V21</th>
<th align="right">V22</th>
<th align="right">V23</th>
<th align="right">V24</th>
<th align="right">V25</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>k</td>
<td align="right">4.000</td>
<td align="right">5.000</td>
<td align="right">6.000</td>
<td align="right">7.000</td>
<td align="right">8.000</td>
<td align="right">9.000</td>
<td align="right">10.000</td>
<td align="right">11.000</td>
<td align="right">12.000</td>
<td align="right">13.000</td>
<td align="right">14.000</td>
<td align="right">15.000</td>
<td align="right">16.000</td>
<td align="right">17.000</td>
<td align="right">18.000</td>
<td align="right">19.000</td>
<td align="right">20.000</td>
<td align="right">21.000</td>
<td align="right">22.000</td>
<td align="right">23.000</td>
<td align="right">24.000</td>
<td align="right">25.000</td>
<td align="right">100.000</td>
<td align="right">500.00</td>
<td align="right">1000.000</td>
</tr>
<tr class="even">
<td>A(k)</td>
<td align="right">1.492</td>
<td align="right">1.534</td>
<td align="right">1.563</td>
<td align="right">1.584</td>
<td align="right">1.601</td>
<td align="right">1.615</td>
<td align="right">1.625</td>
<td align="right">1.634</td>
<td align="right">1.642</td>
<td align="right">1.649</td>
<td align="right">1.654</td>
<td align="right">1.659</td>
<td align="right">1.663</td>
<td align="right">1.667</td>
<td align="right">1.671</td>
<td align="right">1.674</td>
<td align="right">1.677</td>
<td align="right">1.679</td>
<td align="right">1.681</td>
<td align="right">4.795</td>
<td align="right">4.898</td>
<td align="right">4.999</td>
<td align="right">9.999</td>
<td align="right">22.36</td>
<td align="right">31.623</td>
</tr>
<tr class="odd">
<td>a(k)</td>
<td align="right">1.492</td>
<td align="right">1.534</td>
<td align="right">1.563</td>
<td align="right">1.584</td>
<td align="right">1.601</td>
<td align="right">1.615</td>
<td align="right">1.625</td>
<td align="right">1.634</td>
<td align="right">1.642</td>
<td align="right">1.649</td>
<td align="right">1.654</td>
<td align="right">1.659</td>
<td align="right">1.663</td>
<td align="right">1.667</td>
<td align="right">1.671</td>
<td align="right">1.674</td>
<td align="right">1.677</td>
<td align="right">1.679</td>
<td align="right">1.681</td>
<td align="right">1.684</td>
<td align="right">1.686</td>
<td align="right">1.687</td>
<td align="right">1.721</td>
<td align="right">1.73</td>
<td align="right">1.731</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<div id="basic-idea-15" class="section level3">
<h3>(1) Basic idea</h3>
<p>1.Complete data likelihood<br />
<span class="math display">\[L(p,q,r;n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})\]</span> <span class="math display">\[=p^{2n_{AA}}q^{2n_{BB}}r^{2n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{nAB}}\]</span></p>
<p>2.Observed data log-likelihood<br />
<span class="math display">\[\log L(p,q,r;n_{AA},n_{BB},n_{OO},n_{AB},n_{A\cdot},n_{B\cdot})\]</span> <span class="math display">\[=2n_{AA}\log p+2n_{BB}\log q+2n_{OO}\log r+(n_{A\cdot}-n_{AA})\log (2pr)+(n_{B\cdot}-n_{BB})\log (2qr)+n_{AB}log(2pq)\]</span></p>
<p>3.E-step<br />
Notice that <span class="math inline">\(r=1-p-q\)</span>, given <span class="math inline">\(\hat{p}_t,\hat{q}_t\)</span>, we have: <span class="math display">\[E[l(p,q;n_{AA},n_{BB},n_{OO},n_{AB},n_{A\cdot},n_{B\cdot})|n_{OO},n_{AB},n_{A\cdot},n_{B\cdot}]\]</span> <span class="math display">\[
\begin{align}
=&amp;\frac{2\hat{p}_t^2}{\hat{p}_t^2+2\hat{p}_t(1-\hat{p}_t-\hat{q}_t)}n_{A\cdot}\log p+\frac{2\hat{q}_t^2}{\hat{q}_t^2+2\hat{q}_t(1-\hat{p}_t-\hat{q}_t)}n_{B\cdot}\log q+2n_{OO}\log(1-p-q)\\
+&amp;n_{A\cdot}\log (2p(1-p-q))-\frac{\hat{p}_t^2}{\hat{p}_t^2+2\hat{p}_t(1-\hat{p}_t-\hat{q}_t)}n_{A\cdot}\log (2p(1-p-q))\\
+&amp;n_{B\cdot}\log (2q(1-p-q))-\frac{\hat{q}_t^2}{\hat{q}_0^2+2\hat{q}_t(1-\hat{p}_t-\hat{q}_t)}n_{B\cdot}\log (2q(1-p-q))\\
+&amp;n_{AB}\log (2pq)
\end{align}
\]</span></p>
<p>4.M-step<br />
Use function “optim” to find the maximizer of <span class="math inline">\(l\)</span>, denoted as <span class="math inline">\((\hat{p}_{t+1},\hat{q}_{t+1})\)</span></p>
<p>5.Iteraion</p>
</div>
<div id="code-and-output-12" class="section level3">
<h3>(2) Code and output</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">l&lt;-<span class="cf">function</span>(<span class="dt">theta=</span><span class="kw">numeric</span>(<span class="dv">2</span>),pt,qt){</a>
<a class="sourceLine" id="cb61-2" title="2">  na&lt;-<span class="dv">28</span>;nb&lt;-<span class="dv">24</span>;no&lt;-<span class="dv">41</span>;nab&lt;-<span class="dv">70</span></a>
<a class="sourceLine" id="cb61-3" title="3">  p&lt;-theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb61-4" title="4">  q&lt;-theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb61-5" title="5">  rt&lt;-<span class="dv">1</span><span class="op">-</span>pt<span class="op">-</span>qt</a>
<a class="sourceLine" id="cb61-6" title="6">  c1&lt;-pt<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(pt<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pt<span class="op">*</span>rt)</a>
<a class="sourceLine" id="cb61-7" title="7">  c2&lt;-qt<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(qt<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>qt<span class="op">*</span>rt)</a>
<a class="sourceLine" id="cb61-8" title="8">  </a>
<a class="sourceLine" id="cb61-9" title="9">  l&lt;-<span class="dv">2</span><span class="op">*</span>c1<span class="op">*</span>na<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>c2<span class="op">*</span>nb<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>no<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>na<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">-</span>c1<span class="op">*</span>na<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span>nb<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">-</span>c2<span class="op">*</span>nb<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</a>
<a class="sourceLine" id="cb61-10" title="10"><span class="kw">return</span>(<span class="op">-</span>l)</a>
<a class="sourceLine" id="cb61-11" title="11">}</a>
<a class="sourceLine" id="cb61-12" title="12"></a>
<a class="sourceLine" id="cb61-13" title="13">I&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb61-14" title="14">lt&lt;-<span class="kw">numeric</span>()</a>
<a class="sourceLine" id="cb61-15" title="15">theta&lt;-<span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb61-16" title="16"></a>
<a class="sourceLine" id="cb61-17" title="17"><span class="cf">while</span>(I){</a>
<a class="sourceLine" id="cb61-18" title="18">  theta0&lt;-theta</a>
<a class="sourceLine" id="cb61-19" title="19">  MLE&lt;-<span class="kw">optim</span>(<span class="dt">par=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="dt">fn=</span>l,<span class="dt">pt=</span>theta0[<span class="dv">1</span>],<span class="dt">qt=</span>theta0[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb61-20" title="20">  theta&lt;-MLE<span class="op">$</span>par</a>
<a class="sourceLine" id="cb61-21" title="21">  lt&lt;-<span class="kw">c</span>(lt,<span class="op">-</span><span class="dv">1</span><span class="op">*</span>MLE<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb61-22" title="22">  <span class="cf">if</span>(<span class="kw">max</span>(<span class="kw">abs</span>(theta0<span class="op">-</span>theta))<span class="op">&lt;</span><span class="fl">1e-7</span>) I&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb61-23" title="23">}</a>
<a class="sourceLine" id="cb61-24" title="24"></a>
<a class="sourceLine" id="cb61-25" title="25">theta.hat&lt;-<span class="kw">data.frame</span>(<span class="dt">p=</span>theta[<span class="dv">1</span>],<span class="dt">q=</span>theta[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb61-26" title="26"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lt),lt,<span class="dt">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;log L&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(theta.hat)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">p</th>
<th align="right">q</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3273325</td>
<td align="right">0.3104528</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-26" class="section level1">
<h1>2019-12-13</h1>
<div id="p.204-exercise-3" class="section level2">
<h2>p.204 Exercise 3</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">formulas&lt;-<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb63-2" title="2">mpg<span class="op">~</span>disp,</a>
<a class="sourceLine" id="cb63-3" title="3">mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp),</a>
<a class="sourceLine" id="cb63-4" title="4">mpg<span class="op">~</span>disp<span class="op">+</span>wt,</a>
<a class="sourceLine" id="cb63-5" title="5">mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt</a>
<a class="sourceLine" id="cb63-6" title="6">)</a>
<a class="sourceLine" id="cb63-7" title="7"></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="co"># for loops</span></a>
<a class="sourceLine" id="cb63-9" title="9">n&lt;-<span class="kw">length</span>(formulas)</a>
<a class="sourceLine" id="cb63-10" title="10">fit3.loop&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb63-11" title="11"><span class="kw">length</span>(fit3.loop)&lt;-n</a>
<a class="sourceLine" id="cb63-12" title="12"></a>
<a class="sourceLine" id="cb63-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) fit3.loop[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]],mtcars)</a>
<a class="sourceLine" id="cb63-14" title="14"></a>
<a class="sourceLine" id="cb63-15" title="15"><span class="co"># lapply()</span></a>
<a class="sourceLine" id="cb63-16" title="16">fit3.lapply&lt;-<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</a>
<a class="sourceLine" id="cb63-17" title="17"></a>
<a class="sourceLine" id="cb63-18" title="18"><span class="kw">print</span>(fit3.loop)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">print</span>(fit3.lapply)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="p.204-exercise-4" class="section level2">
<h2>p.204 Exercise 4</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">bootprintaps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb67-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb67-3" title="3">mtcars[rows, ]</a>
<a class="sourceLine" id="cb67-4" title="4">})</a>
<a class="sourceLine" id="cb67-5" title="5"></a>
<a class="sourceLine" id="cb67-6" title="6">n&lt;-<span class="kw">length</span>(bootprintaps)</a>
<a class="sourceLine" id="cb67-7" title="7"></a>
<a class="sourceLine" id="cb67-8" title="8"><span class="co"># for loops</span></a>
<a class="sourceLine" id="cb67-9" title="9">fit4.loop&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb67-10" title="10"><span class="kw">length</span>(fit4.loop)&lt;-n</a>
<a class="sourceLine" id="cb67-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) fit4.loop[[i]]&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data=</span>bootprintaps[[i]])</a>
<a class="sourceLine" id="cb67-12" title="12"></a>
<a class="sourceLine" id="cb67-13" title="13"><span class="co"># lapply()</span></a>
<a class="sourceLine" id="cb67-14" title="14">fit4.lapply&lt;-<span class="kw">lapply</span>(bootprintaps,<span class="cf">function</span>(x) <span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data=</span>x))</a>
<a class="sourceLine" id="cb67-15" title="15"></a>
<a class="sourceLine" id="cb67-16" title="16"><span class="co"># lapply() without anonymous function</span></a>
<a class="sourceLine" id="cb67-17" title="17">fit&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb67-18" title="18">  out&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,x)</a>
<a class="sourceLine" id="cb67-19" title="19">  <span class="kw">return</span>(out)</a>
<a class="sourceLine" id="cb67-20" title="20">}</a>
<a class="sourceLine" id="cb67-21" title="21"></a>
<a class="sourceLine" id="cb67-22" title="22">fit4.named&lt;-<span class="kw">lapply</span>(bootprintaps,fit)</a>
<a class="sourceLine" id="cb67-23" title="23"></a>
<a class="sourceLine" id="cb67-24" title="24"><span class="kw">print</span>(fit4.loop)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.89063     -0.03158  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.28597     -0.04104  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.38898     -0.03968  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.34025     -0.04675  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.31071     -0.04653  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.72134     -0.05859  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.05854     -0.04315  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.54717     -0.03652  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.56779     -0.04786  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootprintaps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.98053     -0.03446</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">print</span>(fit4.lapply)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    26.89063     -0.03158  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.28597     -0.04104  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.38898     -0.03968  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.34025     -0.04675  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    31.31071     -0.04653  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    32.72134     -0.05859  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.05854     -0.04315  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.54717     -0.03652  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.56779     -0.04786  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.98053     -0.03446</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">print</span>(fit4.named)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    26.89063     -0.03158  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.28597     -0.04104  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.38898     -0.03968  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.34025     -0.04675  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    31.31071     -0.04653  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    32.72134     -0.05859  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.05854     -0.04315  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.54717     -0.03652  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.56779     -0.04786  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.98053     -0.03446</code></pre>
</div>
<div id="p.204-exercise-5" class="section level2">
<h2>p.204 Exercise 5</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">rsq&lt;-<span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb73-2" title="2"></a>
<a class="sourceLine" id="cb73-3" title="3">model&lt;-<span class="kw">list</span>(fit3.loop,fit3.lapply,fit4.loop,fit4.lapply,fit4.named)</a>
<a class="sourceLine" id="cb73-4" title="4">rsquare&lt;-<span class="kw">lapply</span>(model,<span class="cf">function</span>(x) <span class="kw">lapply</span>(x,rsq))</a>
<a class="sourceLine" id="cb73-5" title="5"></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">print</span>(rsquare)</a></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 0.7183433
## 
## [[1]][[2]]
## [1] 0.8596865
## 
## [[1]][[3]]
## [1] 0.7809306
## 
## [[1]][[4]]
## [1] 0.8838038
## 
## 
## [[2]]
## [[2]][[1]]
## [1] 0.7183433
## 
## [[2]][[2]]
## [1] 0.8596865
## 
## [[2]][[3]]
## [1] 0.7809306
## 
## [[2]][[4]]
## [1] 0.8838038
## 
## 
## [[3]]
## [[3]][[1]]
## [1] 0.6593321
## 
## [[3]][[2]]
## [1] 0.7398154
## 
## [[3]][[3]]
## [1] 0.651476
## 
## [[3]][[4]]
## [1] 0.7850596
## 
## [[3]][[5]]
## [1] 0.8163893
## 
## [[3]][[6]]
## [1] 0.7549664
## 
## [[3]][[7]]
## [1] 0.6611554
## 
## [[3]][[8]]
## [1] 0.6918991
## 
## [[3]][[9]]
## [1] 0.7509602
## 
## [[3]][[10]]
## [1] 0.7407016
## 
## 
## [[4]]
## [[4]][[1]]
## [1] 0.6593321
## 
## [[4]][[2]]
## [1] 0.7398154
## 
## [[4]][[3]]
## [1] 0.651476
## 
## [[4]][[4]]
## [1] 0.7850596
## 
## [[4]][[5]]
## [1] 0.8163893
## 
## [[4]][[6]]
## [1] 0.7549664
## 
## [[4]][[7]]
## [1] 0.6611554
## 
## [[4]][[8]]
## [1] 0.6918991
## 
## [[4]][[9]]
## [1] 0.7509602
## 
## [[4]][[10]]
## [1] 0.7407016
## 
## 
## [[5]]
## [[5]][[1]]
## [1] 0.6593321
## 
## [[5]][[2]]
## [1] 0.7398154
## 
## [[5]][[3]]
## [1] 0.651476
## 
## [[5]][[4]]
## [1] 0.7850596
## 
## [[5]][[5]]
## [1] 0.8163893
## 
## [[5]][[6]]
## [1] 0.7549664
## 
## [[5]][[7]]
## [1] 0.6611554
## 
## [[5]][[8]]
## [1] 0.6918991
## 
## [[5]][[9]]
## [1] 0.7509602
## 
## [[5]][[10]]
## [1] 0.7407016</code></pre>
</div>
<div id="p.214-exercise-3" class="section level2">
<h2>p.214 Exercise 3</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb75-5" title="5">)</a>
<a class="sourceLine" id="cb75-6" title="6"></a>
<a class="sourceLine" id="cb75-7" title="7">p.value&lt;-<span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb75-8" title="8"></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="co"># Extra answer</span></a>
<a class="sourceLine" id="cb75-10" title="10">p.extra&lt;-<span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;p.value&quot;</span>)</a>
<a class="sourceLine" id="cb75-11" title="11"></a>
<a class="sourceLine" id="cb75-12" title="12"><span class="kw">print</span>(p.value)</a></code></pre></div>
<pre><code>##   [1] 0.200836746 0.245123641 0.852744087 0.273557460 0.270730350 0.679201689
##   [7] 0.070024709 0.104319604 0.356578125 0.092627819 0.724787033 0.094210496
##  [13] 0.372187739 0.285201289 0.587994379 0.907977872 0.616601104 0.668651792
##  [19] 0.828357346 0.949270021 0.918928703 0.723265922 0.413778449 0.307190493
##  [25] 0.536102365 0.870082704 0.377623228 0.956711455 0.034992166 0.014152342
##  [31] 0.064941430 0.517088119 0.007323518 0.863697014 0.760789506 0.995171294
##  [37] 0.122870354 0.200164876 0.722819267 0.988238706 0.710795570 0.381533129
##  [43] 0.529668565 0.917570725 0.893040421 0.406581736 0.474557635 0.095234668
##  [49] 0.452578560 0.394861072 0.982962414 0.759885613 0.316184952 0.711235140
##  [55] 0.491334613 0.321299129 0.510750643 0.398690738 0.230428647 0.852977976
##  [61] 0.907440280 0.211776120 0.952187053 0.310155274 0.530621918 0.378312835
##  [67] 0.688123561 0.932175022 0.700080517 0.355316531 0.298281722 0.969770407
##  [73] 0.144771722 0.193304711 0.127176690 0.904741630 0.792255135 0.883822250
##  [79] 0.220724353 0.413733045 0.334979171 1.000000000 0.919964130 0.733374445
##  [85] 0.323586524 0.221786600 0.864300804 0.962196765 0.206297960 0.228569014
##  [91] 0.701583394 0.380377965 0.329664571 0.704033535 0.918030124 0.923001375
##  [97] 0.708198850 0.821952976 0.141769406 0.058115427</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">print</span>(p.extra)</a></code></pre></div>
<pre><code>##   [1] 0.200836746 0.245123641 0.852744087 0.273557460 0.270730350 0.679201689
##   [7] 0.070024709 0.104319604 0.356578125 0.092627819 0.724787033 0.094210496
##  [13] 0.372187739 0.285201289 0.587994379 0.907977872 0.616601104 0.668651792
##  [19] 0.828357346 0.949270021 0.918928703 0.723265922 0.413778449 0.307190493
##  [25] 0.536102365 0.870082704 0.377623228 0.956711455 0.034992166 0.014152342
##  [31] 0.064941430 0.517088119 0.007323518 0.863697014 0.760789506 0.995171294
##  [37] 0.122870354 0.200164876 0.722819267 0.988238706 0.710795570 0.381533129
##  [43] 0.529668565 0.917570725 0.893040421 0.406581736 0.474557635 0.095234668
##  [49] 0.452578560 0.394861072 0.982962414 0.759885613 0.316184952 0.711235140
##  [55] 0.491334613 0.321299129 0.510750643 0.398690738 0.230428647 0.852977976
##  [61] 0.907440280 0.211776120 0.952187053 0.310155274 0.530621918 0.378312835
##  [67] 0.688123561 0.932175022 0.700080517 0.355316531 0.298281722 0.969770407
##  [73] 0.144771722 0.193304711 0.127176690 0.904741630 0.792255135 0.883822250
##  [79] 0.220724353 0.413733045 0.334979171 1.000000000 0.919964130 0.733374445
##  [85] 0.323586524 0.221786600 0.864300804 0.962196765 0.206297960 0.228569014
##  [91] 0.701583394 0.380377965 0.329664571 0.704033535 0.918030124 0.923001375
##  [97] 0.708198850 0.821952976 0.141769406 0.058115427</code></pre>
</div>
<div id="p.214-exercise-7" class="section level2">
<h2>p.214 Exercise 7</h2>
<div id="basic-idea-16" class="section level3">
<h3>(1) Basic idea</h3>
<p>* As mclapply is not available in Windows, I resort to the function “parSapply” in package parallel, a multicore version of sapply.<br />
* However, as vapply prefix the characteristic of output, when doing parallel computation, inputs are allocated into different cores to conduct calculation. Thus so-called “mcvapply” can’t be implemented.<br />
Take a simple example to illuprintate that:<br />
<span class="math display">\[f=\operatorname{function}(x)\ x+1,\\ x_0=\operatorname{c}(1,2,3).\]</span> If you want to calculateand f(x_0), and allocate the calculation to 2 cores, then there’s no way to prefix the proper argument: FUN.VALUE for vapply because the allocation is randomly done. For instance, numeric(1), numeric(2), numeric(3) will all render error warning.</p>
<p>* In the following answer, mcsapply() are implemented to do random sampling.</p>
</div>
<div id="code-and-uotput" class="section level3">
<h3>(2) Code and uotput</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb79-2" title="2">nc&lt;-<span class="kw">detectCores</span>()</a>
<a class="sourceLine" id="cb79-3" title="3">cl&lt;-<span class="kw">makeCluster</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb79-4" title="4"></a>
<a class="sourceLine" id="cb79-5" title="5">n&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb79-6" title="6">fun&lt;-<span class="cf">function</span>(n) <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,n,<span class="dt">replace=</span>T)</a>
<a class="sourceLine" id="cb79-7" title="7"></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co"># mcsapply</span></a>
<a class="sourceLine" id="cb79-9" title="9">mcsapply&lt;-<span class="cf">function</span>(x,f) <span class="kw">parSapply</span>(cl,x,f)</a>
<a class="sourceLine" id="cb79-10" title="10"></a>
<a class="sourceLine" id="cb79-11" title="11"><span class="co"># Compare runtime</span></a>
<a class="sourceLine" id="cb79-12" title="12"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(n,fun))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.83 0.33 5.99</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">system.time</span>(<span class="kw">sapply</span>(n,fun))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 6.00 0.11 6.11</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">stopCluster</span>(cl)</a></code></pre></div>
</div>
</div>
</div>
<div id="section-27" class="section level1">
<h1>2019-12-20</h1>
<div id="question-from-slide" class="section level2">
<h2>Question from slide</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb84-4" title="4"></a>
<a class="sourceLine" id="cb84-5" title="5"><span class="co"># Random walk sampler in C</span></a>
<a class="sourceLine" id="cb84-6" title="6"><span class="kw">cppFunction</span>(</a>
<a class="sourceLine" id="cb84-7" title="7"><span class="st">&#39;List rwC(double sigma, int N){</span></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="st">  NumericVector x(N); double y; double u; int k=0;</span></a>
<a class="sourceLine" id="cb84-9" title="9"></a>
<a class="sourceLine" id="cb84-10" title="10"><span class="st">  x[0]=20;</span></a>
<a class="sourceLine" id="cb84-11" title="11"></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="st">  for(int i=1;i&lt;=(N-1);i++){</span></a>
<a class="sourceLine" id="cb84-13" title="13"><span class="st">    y=rnorm(1,x[i-1],sigma)[0];</span></a>
<a class="sourceLine" id="cb84-14" title="14"><span class="st">    u=runif(1)[0];</span></a>
<a class="sourceLine" id="cb84-15" title="15"></a>
<a class="sourceLine" id="cb84-16" title="16"><span class="st">    if (u&lt;=(exp(-1*abs(y))/exp(-1*abs(x[i-1])))) {</span></a>
<a class="sourceLine" id="cb84-17" title="17"><span class="st">    x[i]=y;</span></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="st">    k++;</span></a>
<a class="sourceLine" id="cb84-19" title="19"><span class="st">    }</span></a>
<a class="sourceLine" id="cb84-20" title="20"><span class="st">    </span></a>
<a class="sourceLine" id="cb84-21" title="21"><span class="st">    else x[i]=x[i-1];</span></a>
<a class="sourceLine" id="cb84-22" title="22"><span class="st">  }</span></a>
<a class="sourceLine" id="cb84-23" title="23"><span class="st">  </span></a>
<a class="sourceLine" id="cb84-24" title="24"><span class="st">  List out=List::create(x,k);</span></a>
<a class="sourceLine" id="cb84-25" title="25"><span class="st">  return (out);</span></a>
<a class="sourceLine" id="cb84-26" title="26"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb84-27" title="27"></a>
<a class="sourceLine" id="cb84-28" title="28"><span class="co"># Random walk sampler in R</span></a>
<a class="sourceLine" id="cb84-29" title="29">rwR&lt;-<span class="cf">function</span>(sigma,N){</a>
<a class="sourceLine" id="cb84-30" title="30">  x&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb84-31" title="31"></a>
<a class="sourceLine" id="cb84-32" title="32">  x[<span class="dv">1</span>]&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb84-33" title="33">  k&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb84-34" title="34">  </a>
<a class="sourceLine" id="cb84-35" title="35">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb84-36" title="36">    y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</a>
<a class="sourceLine" id="cb84-37" title="37">    u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-38" title="38">    </a>
<a class="sourceLine" id="cb84-39" title="39">    <span class="cf">if</span> (u<span class="op">&lt;=</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">*</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))){</a>
<a class="sourceLine" id="cb84-40" title="40">    x[i]&lt;-y</a>
<a class="sourceLine" id="cb84-41" title="41">    k&lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb84-42" title="42">    }</a>
<a class="sourceLine" id="cb84-43" title="43">    </a>
<a class="sourceLine" id="cb84-44" title="44">    <span class="cf">else</span> x[i]&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb84-45" title="45">  }</a>
<a class="sourceLine" id="cb84-46" title="46">  <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">x=</span>x,k))</a>
<a class="sourceLine" id="cb84-47" title="47">}</a>
<a class="sourceLine" id="cb84-48" title="48"></a>
<a class="sourceLine" id="cb84-49" title="49"><span class="co"># Sampling from different sigma</span></a>
<a class="sourceLine" id="cb84-50" title="50">sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb84-51" title="51">N&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb84-52" title="52">xC&lt;-xR&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb84-53" title="53"><span class="kw">length</span>(xC)&lt;-<span class="kw">length</span>(xR)&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb84-54" title="54">rateC&lt;-rateR&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb84-55" title="55"></a>
<a class="sourceLine" id="cb84-56" title="56"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb84-57" title="57"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb84-58" title="58">  outC&lt;-<span class="kw">rwC</span>(sigma[i],N)</a>
<a class="sourceLine" id="cb84-59" title="59">  outR&lt;-<span class="kw">rwR</span>(sigma[i],N)</a>
<a class="sourceLine" id="cb84-60" title="60">  xC[[i]]&lt;-outC[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb84-61" title="61">  xR[[i]]&lt;-outR[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb84-62" title="62">  rateC[i]&lt;-outC[[<span class="dv">2</span>]]<span class="op">/</span>N</a>
<a class="sourceLine" id="cb84-63" title="63">  rateR[i]&lt;-outR[[<span class="dv">2</span>]]<span class="op">/</span>N</a>
<a class="sourceLine" id="cb84-64" title="64">}</a>
<a class="sourceLine" id="cb84-65" title="65"></a>
<a class="sourceLine" id="cb84-66" title="66"><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">rate.Rcpp=</span>rateC,<span class="dt">rate.R=</span>rateR))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">rate.Rcpp</th>
<th align="right">rate.R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">0.9824</td>
<td align="right">0.9828</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">0.8724</td>
<td align="right">0.8320</td>
</tr>
<tr class="odd">
<td align="right">1.00</td>
<td align="right">0.7538</td>
<td align="right">0.7028</td>
</tr>
<tr class="even">
<td align="right">5.00</td>
<td align="right">0.2964</td>
<td align="right">0.2672</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb85-2" title="2">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb85-3" title="3">  <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,xC[[i]],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Rcpp: σ=&quot;</span>,sigma[i]))</a>
<a class="sourceLine" id="cb85-4" title="4">  <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,xR[[i]],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;R: σ=&quot;</span>,sigma[i]))</a>
<a class="sourceLine" id="cb85-5" title="5">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># Comparison</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="co">## Q-Q plot</span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb86-4" title="4">  <span class="kw">qqplot</span>(xC[[i]],xR[[i]],<span class="dt">xlab=</span><span class="st">&quot;Rcpp&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Q-Q plot:σ=&quot;</span>,sigma[i]),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb86-5" title="5">  <span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb86-6" title="6">  }</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmOgBmOjpmZjpmkGZmkJBmkLZmkNtmtttmtv+QOgCQZjqQtpCQttuQ2/+2ZgC2Zjq2ZpC2kGa227a22/+2/9u2///bkDrbkGbbkJDbtmbbtpDb25Db/7bb/9vb////tmb/25D/27b//7b//9v///+xg+LKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJmUlEQVR4nO2da2ObNhiFlXhr3HUXp9212Ra6rSu712nM//9pQxJgMBJHoAtKOc+H1MXOq9cPkhBECFGRScTaCeQOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBDAJOv39Sgjx4of3cGP35p14dvHG6Zd3jimc3ghx9Z0xbgZJGQQ9vhSaT9+CjRO5fHh57ZhL/buSm+lPrZbUWFDznuQczrhxKpfC+DkTpbj6ufpDiNcOCa+Q1FhQWdctWWf/3gtxmNpYF/fbK7332lxkjf9EVsxCZ91uP/26b77J4aF9dXXffo2b9udUwmslNRJUb20+9Xjb7QHjxuIctCmz1Bvql8Ncert6lEsd8KCCXfYXmSQ1ElS/1+7Lov28eWNd3vXb6i/ZUnWZdTH1z1LtTl2bzzkeqg93qhld5lL/X+cyVftXTGokqHlPUnbFGjcWut8oup3SfEn1T/8LN9+kDmJoRk6CVkwKCarj1NXzH3Muqji5QeXStm31iX4uTUjDYXehoJRJ2ZpY+ZWMff1O5/LvcOMgl2O9z1QxbZWXGy5zed3l4tPE1kjK0knXca++FrqA+p//hhsX76ybcXOf0UmvkpTlMF+PqVT3PrVxQXM/jHPRv+p0mF8lqbEgtXu6Q+PExskDhu4VLg4YxlZUym+pxmTm/mDlpAynGh/aAXz/DMmwsR1y1CWMhhyyzY+GHG1HOuQ8qp8QtF5SEyer3/RHrYaNdYX9/UchvrwctH6vPv5GDmcHg9bPTSdM6qN7/QWnBK2W1NTljtObL8b5nje6n9mEJHVSHteD1hEEoCAABQFyErQNKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYDAgoSJnfwRthyvfMScfEILMm3chS/HFWuxO+8IRtrp+9YZFBsXVLYT3Y69aXAw3G52OeFIK+h0d56Ba5lMaBO0Wh9k2b6L0gc93nb3dB0tjWzbgliDEGV7W+DsPigzQSKSoG5uu3U6syGc7qPTCpoe7tQjM/fvHX8ctIagDlOxdS7JBU3tMd3C8hEkU4kmSN73oLqh0v0opoeJGQmq4gkq1f1Z6i62OYJk/clK0G7G955/mD/dyduLnAXtdP+TjSBdgeIIageKxbP3MwTp7mcTgrqBYnHjLKgdceQiSMQU1DWsejjkLmhBOeEY51PNvLow9yimG9npjoKWcRmu9RNF0OOtbPLHWdentidInTb3rjNM57M9QY0a56sLYu4FvKcu6GGvBDlfn8pMkGANmg7X+YkkqLm3vemucT5dF7QNQZVyVJ8fWq/fmQTt5uXzxAUhKMiShu36VGaCBGvQdLizn3wEzT31ecqCesvjuJ48b0uQ/ZzZWuzGBNWGwAqnWxdUj4AmVzgNcOoTJnHLYbU3hSKXTnolQZZwFATCURAIl52gBQNXCpoXwZdBuP4ckywELTn12ZIgIarMBMUrx5WhoGrBuIyC5kTwh4JmhBvMA6SgcbjcBIlFw46PU5Dx3DA/QRHLcSVnQWKLgorrd2p5c/Mq1cNwO9sbKRkIWnRUnZW48vP83m02xUcr6E/rZV71B95CXeTEfwsXoQTZ83FgcLLjJahs/jAwdR1c1ptmniKeTeEpyCUfB3r5+Ak6yqdO1LXiKKx/5q507SmT1CC3fDC9fBYeVfUH1V8H6gpS2rtfyeOtfKbAQecPEtrZ3nDBMR9MKEGqdzndvUDPiVMTAsXE4+QCCXLOBxFOkH6ciVd1HpbrKSh0PmLpwHUgaOrxOtNRRkN7EULQ4nzGxYqlw46BIN8K3U8ohKCQ+eQm6PK2600ImjOb4qMTBL+6ZMZsCl9BLvnMmWm/uMkvGJ84hfMT5MacmfaJBLnPpkglyHWedCpBruFG96XHEmSeaR9w2PHUBbnWoMU1+mkLcp9pv0lB1YyZ9lsVhMhV0M40xX0N/HdYLEGRy3GlE2R7wzlCICjILRwFgXC5CfLIJ4ogw+IqFNQPR0EgHAWBcONh0LqCDEu6rS0odjmu5CnItAAWBfXCUdA4yuACVW6CDF3iyjXIJ6EwaQx3mKHwlQVFL8eVLAUZ10mloHO43ASZWjwF9Yr1yye8oMs/sEQpxxUKAuQoyLyc/nqCzAvbUlBXrLGPpqBzsebV2SmoK5aCprCuzr6eIMvzBmIIcppAtXlBaAJVWkEOa9onFgSnv5gPYpEEuaxpn1gQWqrUtrx/FEFOa9pnVoOSCnJZ0972TJg4gvAEqhVqUDW5pn1KQZV1AtX5iqKlC4rVB+E17RMLQlifMBLtKIbWtF9BUO+pXiNSC8LhKMgcpWvy3gnNZ0qQ9Zk5a9UgCgJkJ8j23K5I4yB8O5R3QmGxPtcsTg1yuB3KO6GwJBY0f3HZheUEwz+fmYnPXVx2aTmhSC5ocTgKAuEoqAlnJWw56fIJn7hofwxfrMU4k3kpUZDD74fPiIJQRAoCESkIRKQgEJGCQEQKAhEpaDNQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQFBBD5/pZeiF50LrATlP9FxISEFyRXfp5+q+Kr3XEg+EesqFDwEFHfWkGD212zYNNjW2GebOhBN0FIdeNtbHAiSmDLcqfgB6gopMalDxwrNDjCTIvjZmWh5v5T0KhUcycQQdc+mjNT4dURRBudSfluaWoEXEEFRm4ac8dz4+x/oIgkowTS8luu7k1cQe9jnUnxb1ZIW8OulSz+DKZBxUFe1dpAvhySqAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBAgmSE3+zWj+b6h8AgpSk8rQElXJCJVPaEFwlbNUhMontCC5lrKeAnNTPTz/aa/qePciIaHyiVKD9Mrlh4d9Xb9lHe9eJCRUPqEFyfl37fLXeq5Z+ex99yJUYQnzCX4Ue32eVNpMELy6716EKixhPmFr0MNe7rZ2Uqn+VybUvghVWMJ8AjcxNUO622OrCwqQT+g+qND9oU5INfWibfPFGn2Qdz6hBambI+RRo/7/w14tyC+PGs2LhITKJ/g4SE2zb8Yd+2/3TS/ZvEhIqHxinqx2t0j43CsRkEX5UBCAggC8HgSgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/ATHltYJDZJWHAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># Microbenchmark: only one comparison when sigma=0.05</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="co"># Because different sigma rendered similar runtime</span></a>
<a class="sourceLine" id="cb87-3" title="3">runtime&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw.R=</span><span class="kw">rwR</span>(sigma[<span class="dv">1</span>],N),<span class="dt">rw.C=</span><span class="kw">rwC</span>(sigma[<span class="dv">1</span>],N))</a>
<a class="sourceLine" id="cb87-4" title="4"><span class="kw">summary</span>(runtime)</a></code></pre></div>
<pre><code>##   expr     min       lq      mean   median       uq      max neval
## 1 rw.R 17.9185 18.50040 21.556244 18.91845 20.21875 123.6352   100
## 2 rw.C  1.1764  1.22015  1.293867  1.25015  1.31655   1.7378   100</code></pre>
<p>By the output, the Rcpp sampler has higher acceptance rate. It can be seen that the Rcpp function runs much faster than the R function. The Q-Q plot shows that the two sample distributions are different, possibly because that the mechanisms to generate random number are different between C++ and R.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
